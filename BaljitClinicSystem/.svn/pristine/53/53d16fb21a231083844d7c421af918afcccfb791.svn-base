<!--
Modification ID     By          Date            Comment
------------------------------------------------------------------------------
yesno01             Aaron       17Dec2018       include yes-no.jsp in the code
c01                 Aaron       17Dec2018       add confirmation box and loading status when user try to update existing record
name01              Aaron       27Dec2018       change name for btnSave
font01              Aaron       08Jan2019       change font and color for mandatory fields
len01               Aaron       08Jan2019       set maxlength for textbox and textarea
link01              Aaron       08Jan2019       link changes of Brand Owner and textarea of Product API
valid01             Aaron       08Jan2019       add validation for numbers
validator01         Aaron       09Jan2019       add condition for validator to see if it is CMS
-->
<%@taglib prefix="jstl" uri="http://java.sun.com/jsp/jstl/core" %>
<jsp:useBean id="DDL" scope="page" class="BusinessLogic.Servlet_PopulateData" />
<style type="text/css">
    .ui-jqgrid tr.jqgrow td {
        word-wrap: break-word; /* IE 5.5+ CSS3 see http://www.w3.org/TR/css3-text/#text-wrap */
        white-space: pre-wrap; /* CSS3 */
        white-space: -moz-pre-wrap; /* Mozilla, since 1999 */
        white-space: -pre-wrap; /* Opera 4-6 */
        white-space: -o-pre-wrap; /* Opera 7 */
        overflow: hidden;
        height: auto;
        vertical-align: middle;
        padding-top: 3px;
        padding-bottom: 3px 
    }

    .centered {
        position: fixed;
        top: 50%;
        left: 50%;
        margin-top: -50px;
        margin-left: -200px;
    }
    div.errorContainer, div.errorContainer2{
        display:none;
        width:100%;
    }
    div.errorContainer, div.errorContainer2 ol li{
        list-style-type:disc;
        margin-left: 20px;
    }
    select:disabled{
        background: #dddddd;
    }
    li{
        list-style:none;
    }
    .disabledTab{
        pointer-events: none;
    }
    input[type="text"].error { border: 1px solid #A94444; background-color:#FFF0F0; }
    select.error { border: 1px solid #A94444; background-color:#FFF0F0; }
    textarea.error { border: 1px solid #A94444; background-color:#FFF0F0; }
    input[type="text"]:read-only {box-shadow: none;}
    textarea:read-only {box-shadow: none;}
</style>
<link rel="stylesheet" type="text/css" href="css/your_style.css" />
<link rel="stylesheet" type="text/css" href="js/plugin/jqgrid/ui.multiselect.css" />
<section id="widget-grid" class="">
    <!--<span>{{params}}</span>-->
    <input type="hidden" value={{params}} id="hidHospCode">

    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-12">
        <h1 class="page-title txt-color-blueDark">
            <!-- PAGE HEADER -->
            <i class="fa-fw fa fa-file fa-2x"></i> 
            Product Detail                                         
        </h1>
    </div>
    <div class="widget-body row">
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="row" style="padding-bottom:10px;padding-left:10px;padding-right:10px;">
                <div class="errorContainer alert alert-danger alert-block">
                    <h4 class="alert-heading">There were some field left out or invalid inputs. Please brief through the form and reenter necessarily.</h4>
                    <ol>
                    </ol>
                </div>
            </div>
            <div class="row">
                <form id="form_ProductDetail" name="form_ProductDetail">
                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-1"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;Product Info</h2></span>
                            </header>
                            <div class="row">
                                <div class="widget-body">

                                    <table id="tbProductInfo" class="table table-bordered table-striped" style="clear:both;">
                                        <tbody>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>Product Code</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="25%"> 
                                                    <input type="text" id="lblPrdCode" name="lblPrdCode" readonly  class="tboxreadonly" rel="popover-hover" data-original-title="Product Code" data-content="A Product Code is a unique mixture of alphanumerical code with a maximum length of 16 characters." maxlength="16" /> <!--len01-->    
                                                </td>
                                                <td width="12%"><font color="red">*</font> <b>Product Description</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="75%">       
                                                    <input type="text" id="lblPrdName" name="lblPrdName" readonly  class="tboxreadonly" rel="popover-hover" data-original-title="Product Description" data-content="A Product description is the Product description with a maximum length of 100 characters." maxlength="100" /> <!--len01-->    
                                                    <input type="text" id="txtPrdName" required name="txtPrdName" class="form-control" style="width:220px;display:none" maxlength="100" /> <!--len01-->    
                                                    
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="12%">Short Name</td>
                                                <td width="1%">:</td>
                                                <td width="25%">     
                                                    <input type="text" id="lblShortName" name="lblShortName" readonly class="tboxreadonly" maxlength="50" /> <!--len01-->
                                                    <input type="text" id="txtShortName" name="txtShortName" class="form-control" style="width:220px;display:none" maxlength="50" /> <!--len01-->   
                                                </td>
                                                <td width="12%">BarCode</td>
                                                <td width="1%">:</td>
                                                <td width="75%">   
                                                    <input type="text" id="lblBarCode" name="lblBarCode" readonly class="tboxreadonly" maxlength="50" /> <!--len01-->    
                                                    <input type="text" id="txtBarCode" name="txtBarCode" class="form-control" style="width:220px;display:none" maxlength="50" /> <!--len01-->
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>Product Group</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="25%"> 
                                                    <input type="text" id="lblPrdGrp" name="lblPrdGrp" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnPrdGrp" name="hdnPrdGrp" class="tboxreadonly" readonly/>
                                                    <label id="selectPrdGrp" class="searchbox" style="width:220px;display:none">
                                                        <select class="form-control" id="ddlPrdGrp" required name="ddlPrdGrp" rel="popover-hover" data-original-title="Product Group" data-content="Select Product Group." style="width:250px;">
                                                            <option value="">- Select Product Group -</option>                                           
                                                        </select>    
                                                    </label>   
                                                </td>
                                                <td width="12%"><font color="red">*</font> <b>Product Type</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="75%">
                                                    <input type="text" id="lblPrdType" name="lblPrdType" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnPrdType" name="hdnPrdType" class="tboxreadonly" readonly/>
                                                    <label id="selectPrdType" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlPrdType" name="ddlPrdType" rel="popover-hover" data-original-title="Product Type" data-content="Select Product Type." style="width:250px;">
                                                            <option value="">- Select Product Type -</option>
                                                        </select>    
                                                    </label>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>Product Category</b></td>
                                                <td width="1%">:</td>
                                                <td colspan="4">
                                                    <input type="text" id="lblPrdCat" name="lblPrdCat" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnPrdCat" name="hdnPrdCat" class="tboxreadonly" readonly/>
                                                    <div id="rdPrdCat" style="display: none;">  
                                                        <input type="radio" id="rdPrdCat2" name="rdPrdCat" value="0"/><label for="rdPrdCat2" class="label-option">Medication</label>
                                                        <input type="radio" id="rdPrdCat3" name="rdPrdCat" value="1"/><label for="rdPrdCat3" class="label-option">Product</label>
                                                        <input type="radio" id="rdPrdCat4" name="rdPrdCat" value="2"/><label for="rdPrdCat4" class="label-option">Consumable</label>
                                                    </div>   
                                                </td>

                                            </tr>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>Default UOM</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="25%"> 
                                                    <input type="text" id="lblDefaultUOM" name="lblDefaultUOM" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnDefaultUOM" name="hdnDefaultUOM" class="tboxreadonly" readonly/>
                                                    <label id="selectUOM" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlPrdUOM" required name="ddlPrdUOM" rel="popover-hover" data-original-title="Product UOM" data-content="Select Product UOM." style="width:250px;">
                                                            <option value="">- Select Product UOM -</option>
                                                        </select>    
                                                    </label>   
                                                </td>
                                                <td width="12%">Default Unit Cost</td>
                                                <td width="1%">:</td>
                                                <td width="75%">
                                                 <input type="text" id="lblUnitCost" name="lblUnitCost" readonly class="tboxreadonly" />    
                                                    <input type="text" id="txtUnitCost" name="txtUnitCost" class="form-control" style="width:220px;display:none" onkeyup="calPharmacyUnitCost()"/>
                                                </td>
                                            </tr>
                                            <tr id="trPharmacy">
                                                <td><font color="red">*</font> <b>Pharmacy UOM</b></td> <!--font01-->
                                                <td>:</td>
                                                <td> 
                                                    <input type="text" id="lblPharmacyUOM" name="lblPharmacyUOM" readonly class="tboxreadonly" />  
                                                    <label id="selectPrdType" class="searchbox">
                                                        <select class="form-control" id="ddlPharmacyUOM" name="ddlPharmacyUOM" rel="popover-hover" onchange="calPharmacyUnitCost()" data-original-title="Pharmacy UOM" data-content="Select Pharmacy UOM." style="width:250px;display:none;">
                                                            <option value="">- Select Pharmacy UOM -</option>
                                                        </select>    
                                                    </label>   
                                                </td>
                                                <td>Pharmacy Unit Cost</td>
                                                <td>:</td>
                                                <td>
                                                    <input type="text" id="lblPharmacyUnitCost" name="lblPharmacyUnitCost" readonly class="tboxreadonly" />   
                                                    <input type="text" id="txtPharmacyUnitCost" name="txtPharmacyUnitCost" class="form-control" style="width:220px;display:none;" value="0.00" disabled/>
                                                    <input type="hidden" id="hdnPharmacyUnitCost" name="hdnPharmacyUnitCost" class="form-control" value="0.00"/>
                                                </td>
                                            </tr>                                            
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>Account Group</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td colspan="4">
                                                    
                                                    <input type="text" id="lblAccGrp" name="lblAccGrp" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnAccGrp" name="hdnAccGrp" class="tboxreadonly" readonly/>
                                                    <label id="selectAccGrp" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlAccGrp" required name="ddlAccGrp" rel="popover-hover" data-original-title="Account Group" data-content="Select Account Group." style="width:250px;">
                                                            <option value="">- Select Account Group -</option>
                                                        </select>    
                                                    </label>                                                                                                         
                                                </td>
                                                
                                            </tr>
                                            
                                            <tr>
                                                <td width="12%">Brand Owner</td>
                                                <td width="1%">:</td>
                                                <td width="25%"> 
                                                    
                                                    <input type="text" id="lblBrandOwner" name="lblBrandOwner" class="tboxreadonly" readonly disabled/>  
                                                    <select class="form-control" id="ddlBrandOwner" name="ddlBrandOwner" style="width:250px;display:none;">
                                                        <option value="">- Select Brand Owner -</option>                                       
                                                    </select>   
                                                    </label>                                                                                                         
                                                </td>
                                                <td>Is Active</td>
                                                <td>:</td>
                                                <td>
                                                       <input type="checkbox" id="chkIsActive" name="chkIsActive" disabled="disabled" /> 
                                                </td>
                                            </tr>

                                            <tr>
                                                <td>Product API</td>
                                                <td>:</td>
                                                <td colspan="4">
                                                    <textarea id="lblPrdAPI" rows="5" style="width:100%;" class="tboxreadonly" readonly disabled>   
                                                    </textarea>
                                                    <textarea id="txtPrdAPI" rows="5" style="width:100%;display:none;" disabled maxlength="20000"> <!--len01-->                                            
                                                    </textarea>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                </div>
                            </div>
                        </div>
                    </article>

                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-2"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;Prescription Information</h2></span>
                            </header>


                            <div class="row">
                                <div class="widget-body">

                                    <table id="tbPrescriptionInfo" class="table table-bordered table-striped" style="clear:both;">
                                        <tbody>
                                            <tr>
                                                <td width="12%">Dosage</td>
                                                <td width="1%">:</td>
                                                <td width="25%">
                                                    <input type="text" id="lblDosage" name="lblDosage" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnDosage" name="hdnDosage" class="tboxreadonly" readonly/>
                                                    <label id="selectDosage" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlDosage" name="ddlDosage" rel="popover-hover" data-original-title="Dosage" data-content="Select Dosage." style="width:250px;">
                                                            <option value="">- Select Dosage -</option>                                          
                                                        </select>    
                                                    </label>
                                                </td>
                                                <td width="12%">Frequency</td>
                                                <td width="1%">:</td>
                                                <td width="75%"> 
                                                    <input type="text" id="lblFreq" name="lblFreq" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnFreq" name="hdnFreq" class="tboxreadonly" readonly/>
                                                    <label id="selectFreq" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlFreq" name="ddlFreq" rel="popover-hover" data-original-title="Frequency" data-content="Select Frequency." style="width:250px;">
                                                            <option value="">- Select Frequency -</option>                                           
                                                        </select>    
                                                    </label>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="12%">Duration</td>
                                                <td width="1%">:</td>
                                                <td width="25%">
                                                    <input type="text" id="lblDuration" name="lblDuration" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnDuration" name="hdnDuration" class="tboxreadonly" readonly/>
                                                    <label id="selectDuration" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlDuration" name="ddlDuration" rel="popover-hover" data-original-title="Duration" data-content="Select Duration." style="width:250px;">
                                                            <option value="">- Select Duration -</option>                                      
                                                        </select>    
                                                    </label>  
                                                </td>
                                                <td width="12%">Precaution</td>
                                                <td width="1%">:</td>
                                                <td width="75%">
                                                    <input type="text" id="lblPrecaution" name="lblPrecaution" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnPrecaution" name="hdnPrecaution" class="tboxreadonly" readonly/>
                                                    <label id="selectPrecaution" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlPrecaution" name="ddlPrecaution" rel="popover-hover" data-original-title="Precaution" data-content="Select Precaution." style="width:250px;">
                                                            <option value="">- Select Precaution -</option>                                       
                                                        </select>    
                                                    </label> 
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="12%">Instruction</td>
                                                <td width="1%">:</td>
                                                <td width="25%">
                                                    <input type="text" id="lblInstruction" name="lblInstruction" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnInstruction" name="hdnInstruction" class="tboxreadonly" readonly/>
                                                    <label id="selectInstruction" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlInstruction" name="ddlInstruction" rel="popover-hover" data-original-title="Instruction" data-content="Select Instruction." style="width:250px;">
                                                            <option value="">- Select Instruction -</option>                                        
                                                        </select>    
                                                    </label> 
                                                </td>
                                                <td width="12%">Indication</td>
                                                <td width="1%">:</td>
                                                <td width="25%">
                                                    <input type="text" id="lblIndication" name="lblIndication" class="tboxreadonly" readonly/>
                                                    <input type="hidden" id="hdnIndication" name="hdnIndication" class="tboxreadonly" readonly/>
                                                    <label id="selectIndication" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlIndication" name="ddlIndication" rel="popover-hover" data-original-title="Indication" data-content="Select Indication." style="width:250px;">
                                                            <option value="">- Select Indication -</option>                                          
                                                        </select>    
                                                    </label> 
                                                </td>


                                                </td>
                                            </tr>


                                        </tbody>
                                    </table>

                                </div>
                            </div>
                        </div>
                    </article>

                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-3"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;Goods Sales Tax (GST) Info</h2></span>
                            </header>
                            <div class="row">
                                <div class="widget-body">
                                    <table id="tbPrescriptionInfo" class="table table-bordered table-striped" style="clear:both;">
                                        <tbody>
                                            <tr>
                                                <td width="12%">GST Tax Code (Purchase)</td>
                                                <td width="1%">:</td>
                                                <td width="20%">
                                                    <input type="text" id="lblGSTPurCode" name="lblGSTPurCode" class="tboxreadonly" readonly/>
                                                    <label id="selectGSTPurCode" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlGSTPurCode" name="ddlGSTPurCode" style="width:200px;">
                                                            <option value="">- Select GST Tax Code (Purchase) -</option>                                       
                                                        </select>    
                                                    </label>
                                                </td>
                                                <td width="12%">GST Tax Code (Medical Supply)</td>
                                                <td width="1%">:</td>
                                                <td width="20%"> 
                                                    <input type="text" id="lblGSTMedSupCode" name="lblGSTMedSupCode" class="tboxreadonly" readonly/>
                                                    <label id="selectGSTMedSupCode" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlGSTMedSupCode" name="ddlGSTMedSupCode" style="width:200px;">
                                                            <option value="">- Select GST Tax Code (Medical Supply) -</option>                                        
                                                        </select>    
                                                    </label>
                                                </td>
                                                <td width="12%">GST Tax Code (OTC Supply)</td>
                                                <td width="1%">:</td>
                                                <td width="20%"> 
                                                    <input type="text" id="lblGSTOTCSupCode" name="lblGSTOTCSupCode" class="tboxreadonly" readonly/>
                                                    <label id="selectGSTOTCSupCode" class="searchbox" style="display: none;">
                                                        <select class="form-control" id="ddlGSTOTCSupCode" name="ddlGSTOTCSupCode" style="width:200px;">
                                                            <option value="">- Select GST Tax Code (OTC Supply) -</option>                                       
                                                        </select>    
                                                    </label>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </article>
                    
                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-4"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;UOM Conversation</h2></span>
                            </header>
                            <div class="padding-10">

                                <div class="table-responsive" id="dvUOM">
                                    <div id="cjqgridUOMConv"></div>
                                    <table id="jqgridUOMConv" class="table table-striped table-bordered"  ></table>
                                    <div id="pjqgridUOMConv"></div>
                                </div>

                                <table  id="tbUOM" class="selection-criteria table-striped " style=" display: none;"  >                                    
                                    <tr>
                                        <th>Base UOM</th>
                                        <td>
                                            <div class="dropdown">
                                                <!--<input type="text" class="form-control searchbox-text" id="txtFromUOM" name="txtFromUOM"  placeholder="Base UOM" style="width: 220px"/>-->
                                                <label id="selectUOMFrom" class="searchbox">
                                                    <select class="form-control" id="ddlUOMFrom" name="ddlUOMFrom" rel="popover-hover" data-original-title="UOM From" data-content="Select UOM From." style="width:250px;">
                                                        <option value="">- UOM From -</option>
                                                    </select>    
                                                </label>   
                                            </div>
                                        </td>
                                        <th>Factor</th>
                                        <td>
                                            <input type="text" class="form-control numeric" id="txtFactor" name="txtFactor" maxlength="100" placeholder="Factor" style="width: 220px"/>
                                        </td>
                                        <th>Convert to UOM</th>
                                        <td>
                                            <!--<input type="text" class="form-control searchbox-text"  id="txtToUOM" name="txtToUOM" placeholder="Convert To UOM" style="width: 220px"/>-->
                                            <label id="selectUOMTo" class="searchbox">
                                                <select class="form-control" id="ddlUOMTo" name="ddlUOMTo" rel="popover-hover" data-original-title="UOM Convert To" data-content="Convert UOM To." style="width:250px;">
                                                    <option value="">- Convert UOM To -</option> 
                                                </select>    
                                            </label> 


                                        </td>
                                        <td align="center">
                                            <button onclick="add_UomConvert();" style="border:none;background:transparent;"><i class='fa fa-plus-square fa-2x'></i></button>
                                        </td>                                    
                                    </tr>
                                </table>

                                <div id="gridUOMSummary" class="" style=" display: none;">
                                    <!--<div id="bar-chart" class="chart"></div>-->

                                    <table  class="table table-striped" id="myTable" >
                                        <thead>
                                        <th>Action</th>
                                        <th style="display:none;">Function</th>
                                        <th style="display:none;">IDX</th>
                                        <th style="display:none;">BaseUOMCODE</th>
                                        <th id="BASEUOM">Base UOM</th>
                                        <th id="FACTOR">Factor</th>
                                        <th style="display:none;">ConvertUOMCODE</th>
                                        <th id="CONVERTTOUOM">Convert To UOM</th>                                   
                                        </thead>
                                        <tbody id="UOMSummaryGrid" >

                                        </tbody>
                                    </table>
                                    <div id="pjqgridpvSummary" class="addDrugTBody"></div>  
                                </div>
                            </div>
                        </div>
                    </article>

                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-5"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;Pricing Table</h2></span>
                            </header>
                            <div class="padding-10">

                                <div class="table-responsive" ID="dvPrice">
                                    <div id="cjqgridPrdPricing"></div>
                                    <table id="jqgridPrdPricing" class="table table-striped table-bordered"  ></table>
                                    <div id="pjqgridPrdPricing"></div>
                                </div>

                                <table  id="tbPricingInfo" class="selection-criteria table-striped " style=" display: none;" >                                    
                                    <tr>
                                        <th>Quantity</th>
                                        <td>
                                            <div class="dropdown">
                                                <input type="text" class="form-control numeric" id="txtQty" name="txtQty"  placeholder="Product Quanity" style="width: 220px" maxlength="6"/> <!--len01-->
                                            </div>
                                        </td>
                                        <th>UOM</th>
                                        <td>
                                            <!--<input type="text" class="form-control" id="txtUOM" name="txtUOM" maxlength="100" placeholder="Product UOM" style="width: 220px"/>-->
                                            <label id="selectUOMPrice" class="searchbox">
                                                <select class="form-control" id="ddlUOMPrice" name="ddlUOMPrice" rel="popover-hover" data-original-title="UOM Pricing" data-content="UOM Pricing." style="width:250px;">
                                                    <option value="">- Select UOM  -</option> 
                                                </select>    
                                            </label> 
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Price 1</th>
                                        <td>
                                            <input type="text" class="form-control numeric"  id="txtPrice1" name="txtPrice1" placeholder="Product Price 1" style="width: 220px"/>
                                        </td>
                                        <th>Price 2</th>
                                        <td>
                                            <input type="text" class="form-control numeric"  id="txtPrice2" name="txtPrice2" placeholder="Product Price 2" style="width: 220px"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Price 3</th>
                                        <td>
                                            <input type="text" class="form-control numeric"  id="txtPrice3" name="txtPrice3" placeholder="Product Price 3" style="width: 220px"/>
                                        </td>
                                        <th>Price 4</th>
                                        <td>
                                            <input type="text" class="form-control numeric"  id="txtPrice4" name="txtPrice4" placeholder="Product Price 4" style="width: 220px"/>
                                        </td>
                                    </tr>
                                    <tr>

                                    </tr>
                                    <td colspan="4" align="center">
                                        <!--                                        <button onclick="add_Pricing();" style="border:none;background:transparent;"><i class='fa fa-plus-square fa-2x'></i></button>-->
                                        <input type="button" Id="btnAddPricing" onclick="add_Pricing();"  class="btn btn-default bg-color-blueDark txt-color-white" value="Add New Pricing" />
                                    </td>                                    
                                    </tr>
                                </table>

                                <div id="gridPricingSummary" class="" style=" display: none;">
                                    <!--<div id="bar-chart" class="chart"></div>-->

                                    <table  class="table table-striped" id="tbPricing" >
                                        <thead>
                                        <th>Action</th>
                                        <th id="QTY">QTY</th>                                        
                                        <th id="UOM">UOM</th>
                                        <th id="PRICE1">Price 1</th>
                                        <th id="PRICE2">Price 2</th>
                                        <th id="PRICE3">Price 3</th>
                                        <th id="PRICE4">Price 4</th>
                                        <th id="UOMCODE" style="display:none;">UOM CODE</th>
                                        <th id="IDX" style="display:none;">IDX</th>
                                        <th id="FUNCTION" style="display:none;">FUNCTION</th>

                                        </thead>
                                        <tbody id="PricingSummaryGrid" >

                                        </tbody>
                                    </table>

                                </div>
                            </div>
                        </div>
                    </article>

                    <div hidden>
                        <input type="hidden" id="hidUOMConvert" name="hidUOMConvert"/>
                        <input type="hidden" id="hidPricing" name="hidPricing"/>

                    </div>

                </form>
            </div>
        </article>
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="row" style="padding-bottom:10px;padding-left:10px;padding-right:10px;">
<!--                <form id="formUploadImg" name="formUploadImg" action="${pageContext.request.contextPath}/Servlet_Media" method="post" enctype="multipart/form-data">-->
<!--                    <article class="col-sm-12 col-md-12 col-lg-12">-->
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-6"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;Media</h2></span>
                            </header>
                            <div class="row">
                                <div class="widget-body">  
                                    <fieldset id="testing">
                                        <form id="formUploadImg" name="formUploadImg" action="${pageContext.request.contextPath}/Servlet_Media" method="post" enctype="multipart/form-data">
                                    <table class="table table-bordered table-striped" style="clear:both;">
                                        <tbody>
                                            <tr>
                                                <td width="15%"> 
                                                    <img id="imgLogo" style="width:150px;height:150px;"/>  
                                                </td>
                                                <td width="85%">
                                                    <input type="file" id="file" name="file" accept="image/gif,image/jpeg,image/png" onchange="previewImg(this);" style="display:none;"/>
                                                    <input type="hidden" id="hidStkCode" name="hidStkCode" />
                                                    <input type="hidden" id="hidType" name="hidType" value="STOCK"/><br>
                                                    <input type="button" id="btnLoad" name="btnLoad" value="Load" class="btn btn-default bg-color-blueDark txt-color-white" onclick="loadLogoFile();" style="display:none;"/>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>    
                                    <input type="submit" id="upload" name="upload" class="btn btn-default bg-color-blueDark txt-color-white" style="display:none;"/>
                                       </form> 
                                    </fieldset>
<!--                                    <input type="submit" id="upload" name="upload" class="btn btn-default bg-color-blueDark txt-color-white" style="display:none;"/>-->
                                </div>
                            </div>
                        </div>
<!--                    </article>-->
<!--                </form> -->
            </div>
        </article>

        <div class="row" style="padding-left:30px;" class="col-sm-12">
            <div class="padding-5" >  
                <input type="button" class="btn btn-default bg-color-blueDark txt-color-white form-btn" id="btnStkUnitCost" name="btnStkUnitCost" value="Stock Unit Cost" onclick="goToStkUnitCost()"/>
                <input type="button" class="btn btn-default bg-color-blueDark txt-color-white form-btn" id="btnStkReorder" name="btnStkReorder" value="Stock Reorder" onclick="goToStkReorder()"/>
                <!--<input type="button" class="btn btn-default bg-color-blueDark txt-color-white form-btn" id="btnStkSupplier" name="btnStkSupplier" value="Stock Supplier" onclick="goToStkSupplier()"/>-->
            </div>
        </div>
        
        <div>
            <div class="row">
                <div class="col-sm-12">
                    <div align="center" class="padding-5" >
                        <input type="button" class="btn btn-default bg-color-blueDark txt-color-white form-btn" id="btnEdit" name="btnEdit" value="Edit Detail" onclick="enableEdit()" style="margin-right:20px;"/>
                        <input type="button" Id="btnSave"  class="btn btn-default bg-color-blueDark txt-color-white" value="Update" style="display: none" onclick ="confirm();" /> <!--name01-->
                        <input type="button" Id="btnCancel"  class="btn btn-default bg-color-blueDark txt-color-white"  value="Cancel" onclick="location.href = '#/ProductMasterList'" />
                        <!--<button type='button' class='DeleteSummaryGrid'><span class='glyphicon glyphicon-trash'></span>Undo</button>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<jsp:include page="../../../includes/loading-no-status.jsp"/>
<!--yesno01-->
<jsp:include page="../../../includes/yes-no.jsp"/>
<!--<script src="js/buttonset.js"></script>-->
<script type="text/javascript">
    //pageSetUp();

    getDLL("ddlPrdGrp", "GET_CODEDESC", "STKGRP", "");
    getDLL("ddlPrdType", "GET_CODEDESC", "STKTYP", "");
    getDLL("ddlPrdUOM", "GET_STOCKUOM", "", "");
    getDLL("ddlAccGrp", "GET_CODEDESC", "ACCGRP", "");
    getDLL("ddlBrandOwner", "GET_BRAND_OWNER", "", "");
    getDLL("ddlDosage", "GET_CODEDESC", "DDOS", "");
    getDLL("ddlFreq", "GET_CODEDESC", "DFRQ", "");
    getDLL("ddlDuration", "GET_CODEDESC", "DDUR", "");
    getDLL("ddlPrecaution", "GET_CODEDESC", "DCAU", "");
    getDLL("ddlInstruction", "GET_CODEDESC", "DINS", "");
    getDLL("ddlIndication", "GET_CODEDESC", "DIND", "");
    getDLL("ddlGSTPurCode", "GET_ACTIVEGSTCODE", "PURCHASE", "");
    getDLL("ddlGSTMedSupCode", "GET_ACTIVEGSTCODE", "SUPPLY", "");
    getDLL("ddlGSTOTCSupCode", "GET_ACTIVEGSTCODE", "SUPPLY", "");
    getDLL("ddlUOMFrom", "GET_STOCKUOM", "", "");
    getDLL("ddlUOMTo", "GET_STOCKUOM", "", "");
    getDLL("ddlUOMPrice", "GET_STOCKUOM", "", "");

    function getDLL (ddl, method, param1, param2) {
        $.get('${pageContext.request.contextPath}/Servlet_PopulateData', {SFC: 'GET_DLL', METHOD: method, P1: param1, P2: param2}, function (data) {
            for(var i=0; i < data.length; i++){                                                          
                $("#"+ddl).append($("<option>").val(data[i].VALUE).html(data[i].TEXT));
            }     
        });     
    }

    //link01
    $("#ddlBrandOwner").change(function(){
        var sBrandOwner = this.value;
        if (sBrandOwner !== ""){
            document.getElementById("txtPrdAPI").disabled = false;
        }
        else{
            document.getElementById("txtPrdAPI").disabled = true;
            document.getElementById("txtPrdAPI").value = "";
        }  
    });

    function bindData(sParam) {

        $.get('${pageContext.request.contextPath}/Servlet_SitesDBInfor', {SFC: 'GET_INTEGRATION_TYPE'}, function (data) {
            if (data.IntegrationType !== "CMS") {
                $('#trPharmacy').hide();
            }
        });
        
        var pagefunction = function () {
            var container = $('div.errorContainer');
            var validator;  //validator01
            $.get('${pageContext.request.contextPath}/Servlet_SitesDBInfor', {SFC: 'GET_INTEGRATION_TYPE'}, function (data) {
                if (data.IntegrationType !== "CMS") { //validator01
                    validator = $("#form_ProductDetail").validate({
                        rules: {
                            txtPrdCode: "required",
                            txtPrdName: "required",
                            ddlPrdGrp: "required",
                            ddlPrdUOM: "required",
                            ddlAccGrp: "required",
                            ddlPrdType: "required",
                            rdPrdCat: "required"


                        },
                        messages: {
                            txtPrdCode: "Product Code cannot be blank.",
                            txtPrdName: "Product Name cannot be blank.",
                            ddlPrdGrp: "Product Group must be selected.",
                            ddlPrdUOM: "Product UOM must be selected.",
                            ddlAccGrp: "Account Group must be selected.",
                            ddlPrdType: "Product Type must be selected.",
                            rdPrdCat: "Product category must be selected."

                        },
                        errorContainer: container,
                        errorLabelContainer: $("ol", container),
                        wrapper: 'li'

                    });
                }
                else{
                    validator = $("#form_ProductDetail").validate({
                        rules: {
                            txtPrdCode: "required",
                            txtPrdName: "required",
                            ddlPrdGrp: "required",
                            ddlPrdUOM: "required",
                            ddlAccGrp: "required",
                            ddlPharmacyUOM: "required",
                            ddlPrdType: "required",
                            rdPrdCat: "required"


                        },
                        messages: {
                            txtPrdCode: "Product Code cannot be blank.",
                            txtPrdName: "Product Name cannot be blank.",
                            ddlPrdGrp: "Product Group must be selected.",
                            ddlPrdUOM: "Product UOM must be selected.",
                            ddlAccGrp: "Account Group must be selected.",
                            ddlPharmacyUOM: "Pharmacy UOM must be selected.",
                            ddlPrdType: "Product Type must be selected.",
                            rdPrdCat: "Product category must be selected."

                        },
                        errorContainer: container,
                        errorLabelContainer: $("ol", container),
                        wrapper: 'li'

                    });
                }
            });
            
            
            loadScript("js/plugin/jqgrid/ui.multiselect.js", function () {
                loadScript("js/plugin/jqgrid/grid.locale-en.min.js", function () {
                    loadScript("js/plugin/jqgrid/jquery.jqGrid.min.js", function () {
                        loadScript("js/column-chooser.js", function () {
                            run_jqgrid_function();
                        });
                    });
                });
            });
            //loadScript("js/plugin/jqgrid/jquery.jqGrid.min.js", run_jqgrid_function);
            function run_jqgrid_function() {


                $.get('${pageContext.request.contextPath}/Servlet_Stock', {PRDCODE: sParam.PRDCODE, SFC: 'GET_PRD_DETAIL'}, function (data) {
                    var arrData = data.object1[0];

                    $('#lblPrdCode, #hidStkCode').val(arrData.stk_stockcode);
                    $('#lblPrdName').val(arrData.stk_desc);
                    $('#lblShortName').val(arrData.stk_shortname);
                    $('#lblBarCode').val(arrData.stk_barcode);
                    $('#hdnPrdGrp').val(arrData.stk_groupcode);
                    $('#lblPrdGrp').val(arrData.GrpCodeDesc);
                    $('#hdnPrdType').val(arrData.stk_typecode);
                    $('#lblPrdType').val(arrData.PrdTypedesc);
                    
                    $('#hdnAccGrp').val(arrData.stk_accountgroup);
                    $('#lblAccGrp').val(arrData.AccGrpdesc);
                    
                    $('#hdnPrdCat').val(arrData.stk_consumable);
                    $('#lblPrdCat').val(arrData.stk_consumableDesc);
                    $('#hdnDefaultUOM').val(arrData.stk_baseuomcode);
                    $('#lblDefaultUOM').val(arrData.UomDesc);
                    $('#hdnDosage').val(arrData.stk_dosagecode);
                    $('#lblDosage').val(arrData.dosageDesc);
                    $('#hdnFreq').val(arrData.stk_frequencycode);
                    $('#lblFreq').val(arrData.FreqDesc);
                    $('#hdnDuration').val(arrData.stk_durationcode);
                    $('#lblDuration').val(arrData.DurationDesc);
                    $('#hdnPrecaution').val(arrData.stk_precautioncode);
                    $('#lblPrecaution').val(arrData.cautiondesc);
                    $('#hdnInstruction').val(arrData.stk_instructioncode);
                    $('#lblInstruction').val(arrData.InstructionDesc);
                    $('#hdnIndication').val(arrData.stk_indicationcode);
                    $('#lblIndication').val(arrData.IndicationDesc);
                    $('#lblGSTPurCode').val(arrData.GSTPurCode); $('#ddlGSTPurCode').val(arrData.GSTPurCode);   
                    $('#lblGSTMedSupCode').val(arrData.GSTMedSupCode); $('#ddlGSTMedSupCode').val(arrData.GSTMedSupCode); 
                    $('#lblGSTOTCSupCode').val(arrData.GSTOTCSupCode); $('#ddlGSTOTCSupCode').val(arrData.GSTOTCSupCode); 
                    if (arrData.IsActive === 'Y') {
                        $('#chkIsActive').prop('checked', true);   
                        $('#chkIsActive').val('Y');
                    }else{
                        $('#chkIsActive').prop('checked', false);  
                        $('#chkIsActive').val('N');
                    }
                    $('#lblBrandOwner, #ddlBrandOwner').val(arrData.BrandOwner);
//                    if ((arrData.stk_mediafiles !== null) && (arrData.stk_mediafiles !== '')) {
//                        $("#imgLogo").attr("src", "http://localhost:8080/InventoryControl/media/stock_media/" + arrData.stk_mediafiles);
//                    }
                    if ((arrData.stk_mediafiles !== null) && (arrData.stk_mediafiles !== '')) {
                        $("#imgLogo").attr("src", "http://13.251.247.226:8088/media/stock/" + arrData.stk_mediafiles);
                    }
                    
                    $('#lblPrdAPI, #txtPrdAPI').val(arrData.stk_api); 
                    $('#lblUnitCost, #txtUnitCost').val(arrData.UnitCost);
                    
                    $('#lblPharmacyUOM').val(arrData.stk_baseuomcode2);
                    $('#txtPharmacyUnitCost, #lblPharmacyUnitCost, #hdnPharmacyUnitCost').val(arrData.stk_unitcost2);
                });

                //UOM Convert Grid
                var grid = $("#jqgridUOMConv"),
                        gridPager = "#p" + grid.selector.toString().substring(1),
                        conDiv = $("#c" + grid.selector.toString().substring(1)),
                        defaultColName = ['UOMIDX', 'Stock Code', 'Stock Name', 'From UOMCODE', 'From UOM', 'Factor', 'To UOMCODE', 'To UOM'],
                        defaultColMol = [
                            {name: 'uomc_uomconvidx', index: 'uomc_uomconvidx', sortable: true, hidden: true},
                            {name: 'uomc_stockcode', index: 'uomc_stockcode', sortable: true, hidden: true},
                            {name: 'stk_desc', index: 'stk_desc', sortable: false, hidden: true},
                            {name: 'uomc_baseuomcode', index: 'uomc_baseuomcode', sortable: true, hidden: true},
                            {name: 'BaseUOMDesc', index: 'BaseUOMDesc', sortable: false},
                            {name: 'uomc_convfactor', index: 'uomc_convfactor', sortable: false},
                            {name: 'uomc_convuomcode', index: 'uomc_convuomcode', sortable: true, hidden: true},
                            {name: 'ConvUOMDesc', index: 'ConvUOMDesc', sortable: true}

                        ],
                        mainGridName = grid.selector.toString().substring(1),
                        //temp = readSettings({settingArray:${sessionScope.settings}, defaultColName: defaultColName, defaultColMol: defaultColMol, settingName: mainGridName});//,
                        temp = readSettings({settingArray: "admin", defaultColName: defaultColName, defaultColMol: defaultColMol, settingName: mainGridName}),
                        currentColName = temp[0],
                        currentColMol = temp[1];
                // alert(JSON.stringify(temp));
                grid.jqGrid({
                    url: '${pageContext.request.contextPath}/Servlet_Stock',
                    postData: {
                        SFC: 'GET_PRODUCTUOMCONV_LIST',
                        PRDCODE: sParam.PRDCODE
                    },
                    datatype: "json",
                    mtype: 'POST',
                    colNames: currentColName,
                    colModel: currentColMol,
                    // rownumbers: true,
                    gridview: true,
                    rownumWidth: 40,
                    rowNum: 20,
                    rowList: [10, 20, 25, 30, 50, 100],
                    pager: gridPager,
                    sortname: 'uomc_stockcode',
                    viewrecords: true,
                    sortorder: 'desc',
                    toolbarfilter: true,
                    autowidth: true,
                    shrinkToFit: true,
                    loadonce: false,
                    height: 'auto',
                    scrollerbar: false,
                    sortable: {
                        update: function (relativeColumnOrder) {
                            //sortColumn({settingArray:${sessionScope.settings}, order: relativeColumnOrder, grid: grid, defaultColMol: defaultColMol, settingName: mainGridName});
                            sortColumn({settingArray: "admin", order: relativeColumnOrder, grid: grid, defaultColMol: defaultColMol, settingName: mainGridName});
                        }
                    },
                    loadComplete: function () {
                        var iLastPage = parseInt($(this).getGridParam('lastpage'));
                        $(".ui-jqgrid .ui-pg-input").keydown(function (e) {
                            this.value = this.value.replace(/\D/g, '');
                            var code = e.keyCode || e.which;
                            if (code === 13) {
                                if (this.value > iLastPage) {
                                    this.value = iLastPage;
                                } else if (this.value <= 0) {
                                    this.value = 1;
                                }
                            }
                        });
                    }
                });



                //Pricing Grid
                var gridPrice = $("#jqgridPrdPricing"),
                        gridPagerPrice = "#p" + gridPrice.selector.toString().substring(1),
                        conDivPrice = $("#c" + gridPrice.selector.toString().substring(1)),
                        defaultColName = ['Price IDX', 'Stock Code', 'Stock Name', 'UOM CODE', 'UOM', 'Factor', 'Unit Price 1', 'Unit Price 2', 'Unit Price 3', 'Unit Price 4'],
                        defaultColMol = [
                            {name: 'sprc_priceidx', index: 'sprc_priceidx', sortable: true, hidden: true},
                            {name: 'sprc_stockcode', index: 'sprc_stockcode', sortable: true, hidden: true},
                            {name: 'stk_desc', index: 'stk_desc', sortable: false, hidden: true},
                            {name: 'sprc_uomcode', index: 'sprc_uomcode', sortable: false, hidden: true},
                            {name: 'uom_uomdesc', index: 'uom_uomdesc', sortable: false},
                            {name: 'sprc_factor', index: 'sprc_factor', sortable: false},
                            {name: 'sprc_unitprice', index: 'sprc_unitprice', sortable: true},
                            {name: 'sprc_unitprice2', index: 'sprc_unitprice2', sortable: true},
                            {name: 'sprc_unitprice3', index: 'sprc_unitprice3', sortable: true},
                            {name: 'sprc_unitprice4', index: 'sprc_unitprice4', sortable: true}
                        ],
                        PriceGrid = gridPrice.selector.toString().substring(1),
                        //temp = readSettings({settingArray:${sessionScope.settings}, defaultColName: defaultColName, defaultColMol: defaultColMol, settingName: mainGridName});//,
                        temp = readSettings({settingArray: "admin", defaultColName: defaultColName, defaultColMol: defaultColMol, settingName: PriceGrid}),
                        currentColName = temp[0],
                        currentColMol = temp[1];
                // alert(JSON.stringify(temp));
                gridPrice.jqGrid({
                    url: '${pageContext.request.contextPath}/Servlet_Stock',
                    postData: {
                        SFC: 'GET_PRODPRICE_LIST',
                        PRDCODE: sParam.PRDCODE
                    },
                    datatype: "json",
                    mtype: 'POST',
                    colNames: currentColName,
                    colModel: currentColMol,
                    // rownumbers: true,
                    gridview: true,
                    rownumWidth: 40,
                    rowNum: 20,
                    rowList: [10, 20, 25, 30, 50, 100],
                    pager: gridPagerPrice,
                    sortname: 'sprc_stockcode',
                    viewrecords: true,
                    sortorder: 'desc',
                    toolbarfilter: true,
                    autowidth: true,
                    shrinkToFit: true,
                    loadonce: false,
                    height: 'auto',
                    scrollerbar: false,
                    sortable: {
                        update: function (relativeColumnOrder) {
                            //sortColumn({settingArray:${sessionScope.settings}, order: relativeColumnOrder, grid: grid, defaultColMol: defaultColMol, settingName: mainGridName});
                            sortColumn({settingArray: "admin", order: relativeColumnOrder, grid: gridPrice, defaultColMol: defaultColMol, settingName: PriceGrid});
                        }
                    },
                    loadComplete: function () {
                        var iLastPage = parseInt($(this).getGridParam('lastpage'));
                        $(".ui-jqgrid .ui-pg-input").keydown(function (e) {
                            this.value = this.value.replace(/\D/g, '');
                            var code = e.keyCode || e.which;
                            if (code === 13) {
                                if (this.value > iLastPage) {
                                    this.value = iLastPage;
                                } else if (this.value <= 0) {
                                    this.value = 1;
                                }
                            }
                        });
                    }
                });



                // remove classes
                $(".ui-jqgrid").removeClass("ui-widget ui-widget-content");
                $(".ui-jqgrid-view").children().removeClass("ui-widget-header ui-state-default");
                $(".ui-jqgrid-labels, .ui-search-toolbar").children().removeClass("ui-state-default ui-th-column ui-th-ltr");
                $(".ui-jqgrid-pager").removeClass("ui-state-default");
                $(".ui-jqgrid").removeClass("ui-widget-content");
                // add classes
                $(".ui-jqgrid-htable").addClass("table table-bordered table-hover");
                $(".ui-jqgrid-btable").addClass("table table-bordered table-striped");
                $(".ui-pg-div").removeClass().addClass("btn btn-sm btn-primary");
                $(".ui-icon.ui-icon-plus").removeClass().addClass("fa fa-plus");
                $(".ui-icon.ui-icon-pencil").removeClass().addClass("fa fa-pencil");
                $(".ui-icon.ui-icon-trash").removeClass().addClass("fa fa-trash-o");
                $(".ui-icon.ui-icon-search").removeClass().addClass("fa fa-search");
                $(".ui-icon.ui-icon-refresh").removeClass().addClass("fa fa-refresh");
                $(".ui-icon.ui-icon-disk").removeClass().addClass("fa fa-save").parent(".btn-primary").removeClass("btn-primary").addClass("btn-success");
                $(".ui-icon.ui-icon-cancel").removeClass().addClass("fa fa-times").parent(".btn-primary").removeClass("btn-primary").addClass("btn-danger");
                $(".ui-icon.ui-icon-seek-prev").wrap("<div class='btn btn-sm btn-default'></div>");
                $(".ui-icon.ui-icon-seek-prev").removeClass().addClass("fa fa-backward");
                $(".ui-icon.ui-icon-seek-first").wrap("<div class='btn btn-sm btn-default'></div>");
                $(".ui-icon.ui-icon-seek-first").removeClass().addClass("fa fa-fast-backward");
                $(".ui-icon.ui-icon-seek-next").wrap("<div class='btn btn-sm btn-default'></div>");
                $(".ui-icon.ui-icon-seek-next").removeClass().addClass("fa fa-forward");
                $(".ui-icon.ui-icon-seek-end").wrap("<div class='btn btn-sm btn-default'></div>");
                $(".ui-icon.ui-icon-seek-end").removeClass().addClass("fa fa-fast-forward");
                $(".ui-pg-input").addClass("pg-input");


                // resize Uom Convert Grid
                $(window).on('resize', function () {
                    grid.jqGrid('setGridWidth', conDiv.width());
                });
                grid.on('myRefresh', function () {
                    resizeWidth({grid: grid, gridDiv: conDiv});
                });
//         quickSetupChooser({grid: grid, defaultColMol: defaultColMol, settingName: mainGridName,
//            settingArray:${sessionScope.settings},
                quickSetupChooser({grid: grid, defaultColMol: defaultColMol, settingName: mainGridName,
                    settingArray: "admin",
                    done: function () {
                        resizeWidth({grid: grid, gridDiv: conDiv});
                    }
                });
                grid.jqGrid('setGridWidth', conDiv.width());

                // resize Price Grid
                $(window).on('resize', function () {
                    gridPrice.jqGrid('setGridWidth', conDivPrice.width());
                });
                gridPrice.on('myRefresh', function () {
                    resizeWidth({grid: gridPrice, gridDiv: conDivPrice});
                });
//         quickSetupChooser({grid: grid, defaultColMol: defaultColMol, settingName: mainGridName,
//            settingArray:${sessionScope.settings},
                quickSetupChooser({grid: gridPrice, defaultColMol: defaultColMol, settingName: PriceGrid,
                    settingArray: "admin",
                    done: function () {
                        resizeWidth({grid: gridPrice, gridDiv: conDivPrice});
                    }
                });
                gridPrice.jqGrid('setGridWidth', conDivPrice.width());


            };
        };
        loadScript("js/plugin/jqgrid/grid.locale-en.min.js", pagefunction);
    }//end of binddata

    $("#chkIsActive").click(function(){
//    alert("here");
        if ( $('#chkIsActive').is(":checked") ) { 
            $('#chkIsActive').val('Y');
        } else if ( $('#chkIsActive').is(":unchecked") )
            $('#chkIsActive').val('N'); {
        }
    });

    $("#ddlPrdUOM").change(function() {             
        refresh_ddlPharmacyUOM();
        
        //check if uom exist in conversion      
        var uom = this.value;
        var bFound = false;
        if ($('#myTable tr').length > 0) {

            $('#myTable tr').each(function (row, th) {
                var sBaseUOM = $(th).find('td:eq(4)').text(); //$(th).find('td:eq(1)').text();
                var sToUOM = $(th).find('td:eq(7)').text(); //$(th).find('td:eq(3)').text();

                if ((uom === sBaseUOM)||(uom === sToUOM)) {
                    bFound = true;
                    return false;
                }                   
            });   
            if (bFound) {
                calPharmacyUnitCost();
            }
        } else {
            calPharmacyUnitCost();
        }       
    });

    function refresh_ddlPharmacyUOM() {
        
        var sDefaultUOM = $('#ddlPrdUOM').val(); 
        var conversionRow = $('#myTable tr').length; 
        
        //if option is not default uom & no longer in conversion, remove
        $('#ddlPharmacyUOM option').each(function(){
            var curUOM = this.value;
            if (conversionRow > 0) {
                
                var bFoundCurUOM = false;
                $('#myTable tr').each(function (row, th) { 
                    var sBaseUOM = $(th).find('td:eq(4)').text(); //$(th).find('td:eq(1)').text();
                    var sToUOM = $(th).find('td:eq(7)').text(); //$(th).find('td:eq(3)').text();
                    
                    if ((curUOM === sBaseUOM)||(curUOM === sToUOM)||(curUOM === sDefaultUOM)) {
                        bFoundCurUOM = true;
                    }                   
                });   
                if (!bFoundCurUOM) {
                    $("#ddlPharmacyUOM option[value='" + curUOM + "']").remove();                   
                }
            } else {
                if (this.value !== sDefaultUOM) {
                    $("#ddlPharmacyUOM option[value='" + curUOM + "']").remove();
                } 
            }
        });
        
        //if default uom not yet in list, insert
        var bFoundDefaultUOM = false;
        $('#ddlPharmacyUOM option').each(function(){
            if (this.value === sDefaultUOM) {
                bFoundDefaultUOM = true;
            }                   
        });
        if (!bFoundDefaultUOM) {
            $('#ddlPharmacyUOM').append($('<option></option>').val(sDefaultUOM).html(sDefaultUOM));
        }
        
        //if uom conversion not yet in list, insert
        $('#myTable tr').each(function (row, th) {
            if (row !== 0) {    
                var sBaseUOM = $(th).find('td:eq(4)').text(); //$(th).find('td:eq(1)').text();
                var sToUOM = $(th).find('td:eq(7)').text(); //$(th).find('td:eq(3)').text();
                               
                var bFoundBaseUOM = false, bFoundToUOM = false;
                $('#ddlPharmacyUOM option').each(function(){
                    if (this.value === sBaseUOM) {
                        bFoundBaseUOM = true;
                    }                   
                    if (this.value === sToUOM) {
                        bFoundToUOM = true;
                    }
                });
                
                if (!bFoundBaseUOM) {
                    $('#ddlPharmacyUOM').append($('<option></option>').val(sBaseUOM).html(sBaseUOM));
                }
                if (!bFoundToUOM) {
                    $('#ddlPharmacyUOM').append($('<option></option>').val(sToUOM).html(sToUOM));
                }
            }                             
        });      
        
        if ($('#ddlPharmacyUOM').val() === "") {
            $('#txtPharmacyUnitCost, #hdnPharmacyUnitCost').val('0.00');
        }
    }

    function calPharmacyUnitCost() {
        var sPharmacyUOM = $("#ddlPharmacyUOM").val();
        var sDefaultUOM = $("#ddlPrdUOM").val();
        var dUnitCost = $("#txtUnitCost").val();
        
        if (sPharmacyUOM !== "") {

            if (sPharmacyUOM === sDefaultUOM) {
                $("#txtPharmacyUnitCost, #hdnPharmacyUnitCost").val(dUnitCost);
            } else {                   
                var tempCurUOM = "", tempUnitCost = 0;
                $('#myTable tr').each(function (row, th) {
                    var sBaseUOM = $(th).find('td:eq(4)').text();  //$(th).find('td:eq(1)').text();  
                    var iFactor = $(th).find('td:eq(5)').text();  //$(th).find('td:eq(2)').text();
                    var sToUOM = $(th).find('td:eq(7)').text();  //$(th).find('td:eq(3)').text();

                    if (sBaseUOM === sDefaultUOM) { 
                        tempCurUOM = sToUOM;
                        tempUnitCost = dUnitCost / iFactor; 
                        return false;
                    }
                });  

                var iCount = 0;
                while ((tempCurUOM !== sPharmacyUOM) && (iCount < 10)) {                   
                    $('#myTable tr').each(function (row, th) { 
                        var sBaseUOM = $(th).find('td:eq(4)').text();  //$(th).find('td:eq(1)').text();
                        var iFactor = $(th).find('td:eq(5)').text();  //$(th).find('td:eq(2)').text();
                        var sToUOM = $(th).find('td:eq(7)').text();  //$(th).find('td:eq(3)').text();

                        if (sBaseUOM === tempCurUOM) {
                            tempCurUOM = sToUOM; 
                            tempUnitCost = tempUnitCost / iFactor; 
                            return false;
                        }
                    });  
                    iCount++;
                }
                if (tempCurUOM === sPharmacyUOM) {
                    $("#txtPharmacyUnitCost, #hdnPharmacyUnitCost").val(tempUnitCost.toFixed(2));
                } else {
                    $("#txtPharmacyUnitCost, #hdnPharmacyUnitCost").val("0.00");
                }
            }
        } else {
            $("#txtPharmacyUnitCost, #hdnPharmacyUnitCost").val("0.00");
        }
    }    

    function goToStkUnitCost(){
        var sStkCode = $('#lblPrdCode').val();
        var sDefaultUOM = $('#hdnDefaultUOM').val(); 
        location.href = '#/StockUnitCost/' + sStkCode + '/' + sDefaultUOM;
        
    }

    function goToStkReorder(){
        var sStkCode = $('#lblPrdCode').val();
        var sDefaultUOM = $('#hdnDefaultUOM').val(); 
        location.href = '#/StockReorder/' + sStkCode + '/' + sDefaultUOM;
    }
    
    function goToStkSupplier(){
        var sStkCode = $('#lblPrdCode').val();
        var sDefaultUOM = $('#hdnDefaultUOM').val(); 
        location.href = '#/StockSupplier/' + sStkCode + '/' + sDefaultUOM;
    }

    function enableEdit() {
        $.showLoadingNoStatus();
        $('#file').show();
        $('#chkIsActive').prop('disabled', false);       
        document.getElementById('btnSave').style.display = '';
        document.getElementById('btnEdit').style.display = 'none';

        document.getElementById('lblShortName').style.display = 'none';
        document.getElementById('txtShortName').value = document.getElementById('lblShortName').value;
        document.getElementById('txtShortName').style.display = '';

        document.getElementById('lblPrdName').style.display = 'none';
        document.getElementById('txtPrdName').value = document.getElementById('lblPrdName').value;
        document.getElementById('txtPrdName').style.display = '';

        document.getElementById('lblBarCode').style.display = 'none';
        document.getElementById('txtBarCode').value = document.getElementById('lblBarCode').value;
        document.getElementById('txtBarCode').style.display = '';

        document.getElementById('lblPrdGrp').style.display = 'none';
        document.getElementById('ddlPrdGrp').value = document.getElementById('hdnPrdGrp').value;
        document.getElementById('selectPrdGrp').style.display = '';

        document.getElementById('lblPrdType').style.display = 'none';
        document.getElementById('ddlPrdType').value = document.getElementById('hdnPrdType').value;
        document.getElementById('selectPrdType').style.display = '';
        
        document.getElementById('lblAccGrp').style.display = 'none';
        document.getElementById('ddlAccGrp').value = document.getElementById('hdnAccGrp').value;
        document.getElementById('selectAccGrp').style.display = '';

        document.getElementById('lblPrdCat').style.display = 'none';
        // document.getElementById('rdPrdCat').value = document.getElementById('hdnPrdCat').value;
        $(":radio[name='rdPrdCat'][value=" + document.getElementById('hdnPrdCat').value + "]").attr('checked', 'checked');
        document.getElementById('rdPrdCat').style.display = '';


        document.getElementById('lblDefaultUOM').style.display = 'none';
        document.getElementById('ddlPrdUOM').value = document.getElementById('hdnDefaultUOM').value;
        document.getElementById('selectUOM').style.display = '';

 document.getElementById('lblUnitCost').style.display = 'none';
        document.getElementById('txtUnitCost').value = document.getElementById('lblUnitCost').value;
        document.getElementById('txtUnitCost').style.display = '';
        
        document.getElementById('lblDosage').style.display = 'none';
        document.getElementById('ddlDosage').value = document.getElementById('hdnDosage').value;
        document.getElementById('selectDosage').style.display = '';

        document.getElementById('lblFreq').style.display = 'none';
        document.getElementById('ddlFreq').value = document.getElementById('hdnFreq').value;
        document.getElementById('selectFreq').style.display = '';

        document.getElementById('lblDuration').style.display = 'none';
        document.getElementById('ddlDuration').value = document.getElementById('hdnDuration').value;
        document.getElementById('selectDuration').style.display = '';

        document.getElementById('lblPrecaution').style.display = 'none';
        document.getElementById('ddlPrecaution').value = document.getElementById('hdnPrecaution').value;
        document.getElementById('selectPrecaution').style.display = '';

        document.getElementById('lblInstruction').style.display = 'none';
        document.getElementById('ddlInstruction').value = document.getElementById('hdnInstruction').value;
        document.getElementById('selectInstruction').style.display = '';
        
        document.getElementById('lblIndication').style.display = 'none';
        document.getElementById('ddlIndication').value = document.getElementById('hdnIndication').value;
        document.getElementById('selectIndication').style.display = '';

        document.getElementById('lblGSTPurCode').style.display = 'none';
        document.getElementById('selectGSTPurCode').style.display = '';
        document.getElementById('lblGSTMedSupCode').style.display = 'none';
        document.getElementById('selectGSTMedSupCode').style.display = '';
        document.getElementById('lblGSTOTCSupCode').style.display = 'none';
        document.getElementById('selectGSTOTCSupCode').style.display = '';

        document.getElementById('tbUOM').style.display = '';
        document.getElementById('tbPricingInfo').style.display = '';
        document.getElementById('gridUOMSummary').style.display = '';
        document.getElementById('gridPricingSummary').style.display = '';
        document.getElementById('dvUOM').style.display = 'none';
        document.getElementById('dvPrice').style.display = 'none';

        $('#lblBrandOwner').hide(); $('#ddlBrandOwner').show();
        $('#lblPrdAPI').hide(); $('#txtPrdAPI').show();
        $('#lblUnitCost').hide(); $('#txtUnitCost').show();
        $('#lblPharmacyUnitCost, #lblPharmacyUOM').hide(); 
        $('#txtPharmacyUnitCost, #ddlPharmacyUOM').show();
                      
        var allUOMRowsInGrid = jQuery("#jqgridUOMConv").jqGrid('getRowData');

        var allPriceRowsInGrid = jQuery("#jqgridPrdPricing").jqGrid('getRowData');


        for (var i = 0; i < allUOMRowsInGrid.length; i++) {
            
            var $table = $(this).closest('table'),
                    CodeIDX = allUOMRowsInGrid[i].uomc_uomconvidx,
                    FromUOMCode = allUOMRowsInGrid[i].uomc_baseuomcode,
                    FromUOM = allUOMRowsInGrid[i].BaseUOMDesc,
                    Factor = allUOMRowsInGrid[i].uomc_convfactor,
                    ToUOMCode = allUOMRowsInGrid[i].uomc_convuomcode,
                    ToUOM = allUOMRowsInGrid[i].ConvUOMDesc;

            $("#myTable tbody").append("<tr>" +
                    "<td width='15%'>" +
                    "<button type='button' class='editSummaryGrid' onclick='summaryEdit(this);'><span class='glyphicon glyphicon-pencil'></span>Edit</button>&nbsp;\n\
                     <button type='button' class='editSummaryGrid' onclick='summaryUOMDelete(this);'><span class='glyphicon glyphicon-trash'></span>Delete</button>\n\
                     <button type='button' class='DeleteSummaryGrid' onclick='UndoDelete(this);'>Undo</button>\n\
                     <button  class='btnSummaryGrid' onclick='saveSummaryChanges(this);'><span class='glyphicon glyphicon-save'></span>Save</button>&nbsp;\n\
                     <button  class='btnSummaryGrid' onclick='summaryCancel(this);'>Cancel</button>\n\
                    </td>" +
                    "<td width='0%' style='display:none;'><label class='labelUomFUNCTION'>NO</label></td>" +
                    "<td width='0%' style='display:none;'><label class='labelCodeIDX'>" + CodeIDX + "</label></td>" +
                    "<td width='0%' style='display:none;'><label class='labelFromUOMCode'>" + FromUOMCode + "</label></td>" +
                    "<td width='30%'><label class='labelFromUOM'>" + FromUOM + "</label><input type='text' class='modalFromUOM' ID='editConvFromUOM' readonly disabled='disabled' value=" + FromUOM + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>" +
                    "<td width='30%'><label class='labelFactor'>" + Factor + "</label><input type='text' class='modalFactor'  value=" + Factor + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>" +
                    "<td width='0%' style='display:none;'><label class='labelFromUOMCode'>" + ToUOMCode + "</label></td>" +
                    "<td width='30%'><label class='labelToUOM'>" + ToUOM + "</label><input type='text' class='modalToUOM' ID='editConvToUOM' readonly disabled='disabled' value=" + ToUOM + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>"
                    + "</tr>");

            $(".editSummaryGrid").show();
            $(".DeleteSummaryGrid").hide();
            $(".btnSummaryGrid").hide();
            $('#ddlUOMFrom').val('');
            $('#txtFactor').val('');
            $('#ddlUOMTo').val('');
}

        refresh_ddlPharmacyUOM();
        $('#ddlPharmacyUOM').val($('#lblPharmacyUOM').val());   
        $('#txtPharmacyUnitCost, #hdnPharmacyUnitCost').val($('#lblPharmacyUnitCost').val());   

        for (var x = 0; x < allPriceRowsInGrid.length; x++) {
            
            var $table = $(this).closest('table'),
                    QTY = allPriceRowsInGrid[x].sprc_factor, //$('#txtQty').val(),
                    UOM = allPriceRowsInGrid[x].uom_uomdesc, //$('#ddlUOMPrice').val(),
                    PRICE1 = allPriceRowsInGrid[x].sprc_unitprice, //$('#txtPrice1').val(),
                    PRICE2 = allPriceRowsInGrid[x].sprc_unitprice2, //$('#txtPrice2').val(),
                    PRICE3 = allPriceRowsInGrid[x].sprc_unitprice3, //$('#txtPrice3').val(),
                    PRICE4 = allPriceRowsInGrid[x].sprc_unitprice4,
                    UOMCODE = allPriceRowsInGrid[x].sprc_uomcode,
                    IDX = allPriceRowsInGrid[x].sprc_priceidx;

//                    alert("UOMCODE : " + UOMCODE + " IDX : " + IDX + " QTY : " + QTY);
            $("#tbPricing tbody").append("<tr>" +
                    "<td width='160px'>" +
                    "<button type='button' class='editSummaryGrid' onclick='summaryEdit(this);'><span class='glyphicon glyphicon-pencil'></span>Edit</button>\n\
                    <button type='button' class='editSummaryGrid' onclick='summaryPriceDelete(this);'><span class='glyphicon glyphicon-trash'></span>Delete</button>\n\
                    <button type='button' class='DeleteSummaryGrid' onclick='UndoPriceDelete(this);'>Undo</button>\n\
                    <button  class='btnSummaryGrid' onclick='savePricingChanges(this);'><span class='glyphicon glyphicon-save'></span>Save</button>\n\
                    <button  class='btnSummaryGrid' onclick='summaryCancel(this);'>Cancel</button>\n\
                </td>" +
                    "<td><label class='labelQty'>" + QTY + "</label><input type='text' class='modalQty' disabled='disabled' value=" + QTY + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelUOM'>" + UOM + "</label><input type='text' class='modalUOM' ID='editPriceUOM' readonly   value=" + UOM + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice1'>" + PRICE1 + "</label><input type='text' class='modalPrice1' disabled='disabled' value=" + PRICE1 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice2'>" + PRICE2 + "</label><input type='text' class='modalPrice2' disabled='disabled' value=" + PRICE2 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice3'>" + PRICE3 + "</label><input type='text' class='modalPrice3' disabled='disabled' value=" + PRICE3 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice4'>" + PRICE4 + "</label><input type='text' class='modalPrice4' disabled='disabled' value=" + PRICE4 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td width='0%' style='display:none;' ><label class='labelUOMCode'>" + UOMCODE + "</label></td>" +
                    "<td width='0%' style='display:none;' ><label class='labelCodeIDX'>" + IDX + "</label></td>" +
                    "<td width='0%' style='display:none;'><label class='labelPriceFUNCTION'>NO</label></td>" +
                    "</tr>"
                    );
            $(".editSummaryGrid").show();
            $(".DeleteSummaryGrid").hide();
            $(".btnSummaryGrid").hide();
            $('#txtQty').val('');
            $('#ddlUOMPrice').val('');
            $('#txtPrice1').val('');
            $('#txtPrice2').val('');
            $('#txtPrice3').val('');
            $('#txtPrice4').val('');

        }

        $.hideLoadingNoStatus();
    }

    function summaryEdit(e) {

        var $this = $(e),
                $td = $this.closest('td'),
                $tr = $this.closest('tr');
        $tr.find('td').each(function () {
            $(this).find('label').hide();
            $(this).find('input').show();
        });
        var btnSummaryGrid = $td.find('button.btnSummaryGrid'),
                editSummaryGrid = $td.find('button.editSummaryGrid'),
                $closestTR = $this.closest('tr');
        // modalFactor = $closestTR.find('input.modalFactor').val();

        // editmodalFactor = $closestTR.find('input.modalFactor').val();
        // editModalTotalPrice = $closestTR.find('input.modalItemPrice').val();

        //summaryGridModalTbody
        $closestTR.find('input').prop('disabled', false);
        // $closestTR.find('input').css('class', 'form-control searchbox-text');
        $closestTR.find('input').css('border', '1px solid #ccc');
        //class="form-control searchbox-text"
        $closestTR.find('input#editPriceUOM').prop('disabled', false);
        $closestTR.find('input#editPriceUOM').css('border', '1px solid #fff');

        $closestTR.find('input#editConvFromUOM').prop('disabled', false);
        $closestTR.find('input#editConvFromUOM').css('border', '1px solid #fff');

        $closestTR.find('input#editConvToUOM').prop('disabled', false);
        $closestTR.find('input#editConvToUOM').css('border', '1px solid #fff');

        // $closestTR.find('input.modalUOM').css('display', 'block');

        btnSummaryGrid.show();
        editSummaryGrid.hide();
    }

    function summaryCancel(e) {
        $(".editSummaryGrid").show();
        $(".btnSummaryGrid").hide();
        $(e).closest('tr').find('input').prop('disabled', true);
        $(e).closest('tr').find('input').css('border', 'none');
        $(e).closest('tr').find('td').each(function () {
            $(this).find('label').show();
            $(this).find('input').hide();
        });
    }

    function saveSummaryChanges(e) {
        //alert(e);

        var closestTR = $(e).closest('tr'),
                modalFromUOM = closestTR.find('input.modalFromUOM').val(),
                modalFactor = closestTR.find('input.modalFactor').val(),
                modalToUOM = closestTR.find('input.modalToUOM').val();
        //valid01
        var $validFactor = twoDeci(modalFactor);
        if ($validFactor === false){
            $.bigBoxFail({
                title: "Invalid Factor.",
                content: "Please enter a factor and try again...",
                timeout: 6000
            });
        }
        else{
        closestTR.find('label.labelFromUOM').html(modalFromUOM);
        closestTR.find('label.labelFactor').html(modalFactor);
        closestTR.find('label.labelToUOM').html(modalToUOM);
        closestTR.find('label.labelUomFUNCTION').html('UPDATE');


        $(".editSummaryGrid").show();
        $(".btnSummaryGrid").hide();
        $(e).closest('tr').find('input').prop('disabled', true);
        $(e).closest('tr').find('input').css('border', 'none');
        $(e).closest('tr').find('td').each(function () {
            $(this).find('label').show();
            $(this).find('input').hide();
        });
        
        calPharmacyUnitCost();
    }

    }

    function savePricingChanges(e) {
        //alert(e);

        var closestTR = $(e).closest('tr'),
                modalQty = closestTR.find('input.modalQty').val(),
                modalUOM = closestTR.find('input.modalUOM').val(),
                modalPrice1 = closestTR.find('input.modalPrice1').val(),
                modalPrice2 = closestTR.find('input.modalPrice2').val(),
                modalPrice3 = closestTR.find('input.modalPrice3').val(),
                modalPrice4 = closestTR.find('input.modalPrice4').val();

        //valid01
        var $validQty = intNum(modalQty);
        var $validPrice1 = doubleNum(modalPrice1);
        var $validPrice2 = doubleNum(modalPrice2);
        var $validPrice3 = doubleNum(modalPrice3);
        var $validPrice4 = doubleNum(modalPrice4);
        
        //valid01
        if ($validQty === false){
            $.bigBoxFail({
                title: "Invalid Quantity.",
                content: "Please enter a valid amount of quantity and try again...",
                timeout: 6000
            });
        }
        //valid01
        else if ($validPrice1 === false || $validPrice2 === false || $validPrice3 === false || $validPrice4 === false){
            $.bigBoxFail({
                title: "Invalid inputs.",
                content: "Please check the input for:<br>1. Price 1<br>2. Price 2<br>3. Price 3<br>4. Price 4",
                timeout: 6000
            });
        }
        else{
        closestTR.find('label.labelQty').html(modalQty);
        closestTR.find('label.labelUOM').html(modalUOM);
        closestTR.find('label.labelPrice1').html(modalPrice1);
        closestTR.find('label.labelPrice2').html(modalPrice2);
        closestTR.find('label.labelPrice3').html(modalPrice3);
        closestTR.find('label.labelPrice4').html(modalPrice4);
        closestTR.find('label.labelPriceFUNCTION').html('UPDATE');


        $(".editSummaryGrid").show();
        $(".btnSummaryGrid").hide();
        $(e).closest('tr').find('input').prop('disabled', true);
        $(e).closest('tr').find('input').css('border', 'none');
        $(e).closest('tr').find('td').each(function () {
            $(this).find('label').show();
            $(this).find('input').hide();
        });
        }

        




    }

    function UndoDelete(e) {
        var closestTR = $(e).closest('tr'),
                modalFromUOM = closestTR.find('input.modalFromUOM').val(),
                modalFactor = closestTR.find('input.modalFactor').val(),
                modalToUOM = closestTR.find('input.modalToUOM').val();
        //modalFunction = closestTR.find('label.labelUomFUNCTION').val();

        closestTR.find('label.labelFromUOM').html(modalFromUOM);
        closestTR.find('label.labelFactor').html(modalFactor);
        closestTR.find('label.labelToUOM').html(modalToUOM);
        closestTR.find('label.labelUomFUNCTION').html('NO');

        closestTR.find('td').prop('disabled', false);
        // $closestTR.find('input').css('class', 'form-control searchbox-text');
        closestTR.find('td').css('background', 'transparent');

        // alert(e);

        // if (closestTR.find('label.labelUomFUNCTION').html('DELETE') !== 'DELETE') {
        $(".editSummaryGrid").show();
        $(".DeleteSummaryGrid").hide();
        $(".btnSummaryGrid").hide();

        $(e).closest('tr').find('td').each(function () {

            // $(this).find('label').css('background', 'transparent');
            //$(this).find('input').hide();
        });

    }

    function UndoPriceDelete(e) {
        var closestTR = $(e).closest('tr');

        closestTR.find('label.labelPriceFUNCTION').html('NO');

        closestTR.find('td').prop('disabled', false);
        closestTR.find('td').css('background', 'transparent');

        $(".editSummaryGrid").show();
        $(".DeleteSummaryGrid").hide();
        $(".btnSummaryGrid").hide();


    }

    function summaryDelete(e) {
        $(e).closest('tr').remove();
    }

    function summaryUOMDelete(e) {

        //$(e).closest('tr').remove();
        var closestTR = $(e).closest('tr');//,

        closestTR.find('label.labelUomFUNCTION').html('DELETE');

        closestTR.find('td').prop('disabled', false);
        closestTR.find('td').css('background', '#800000');

        closestTR.find('button.DeleteSummaryGrid').show();
        closestTR.find('button.editSummaryGrid').hide();
        closestTR.find('button.btnSummaryGrid').hide();

    }

    function summaryPriceDelete(e) {

        //$(e).closest('tr').remove();

        var closestTR = $(e).closest('tr');

        closestTR.find('label.labelPriceFUNCTION').html('DELETE');

        closestTR.find('td').prop('disabled', false);
        // $closestTR.find('input').css('class', 'form-control searchbox-text');
        closestTR.find('td').css('background', '#800000');


        closestTR.find('button.DeleteSummaryGrid').show();
        closestTR.find('button.editSummaryGrid').hide();
        closestTR.find('button.btnSummaryGrid').hide();

    }


    function add_UomConvert() {
        //alert('aaa');
        var booleanValue = true;
        //valid01
        var $validFactor = twoDeci($("#txtFactor").val());
        if ($('#ddlUOMFrom').val() === "" || $('#txtFactor').val() === "" || $('#ddlUOMTo').val() === "") {
            //alert("Please Enter data to Add Row");
            //return false;
             $.bigBoxFail({
                title: "Create UOM Conversation Fail.",
                content: "Create UOM Conversation Fail.",
                timeout: 6000
            });
            return false;
        }
        //valid01
        if ($validFactor === false){
            $.bigBoxFail({
                title: "Invalid Factor.",
                content: "Please enter a factor and try again...",
                timeout: 6000
            });
            return false;
        }
        var allUOMRowsInGrid = jQuery("#jqgridUOMConv").jqGrid('getRowData');

        if (allUOMRowsInGrid.length > 0) {
            booleanValue = Check_UomConvert($('#ddlUOMFrom').val(), $('#ddlUOMTo').val(), $('#txtFactor').val());
        } else {
            booleanValue = true;
        }


        // alert("booleanValue-->" + booleanValue);
        if (booleanValue === true) {
            var $table = $(this).closest('table'),
                    FromUOMCode = $('#ddlUOMFrom').val(),
                    FromUOM = $('#ddlUOMFrom option:selected').text(),
                    Factor = $('#txtFactor').val(),
                    ToUOMCode = $('#ddlUOMTo').val(),
                    ToUOM = $('#ddlUOMTo option:selected').text();

            $("#myTable tbody").append("<tr>" +
                    "<td>" +
                    "<button type='button' class='editSummaryGrid' onclick='summaryEdit(this);'><span class='glyphicon glyphicon-pencil'></span>Edit</button>&nbsp;\n\
                                         <button type='button' class='editSummaryGrid' onclick='summaryDelete(this);'><span class='glyphicon glyphicon-trash'></span>Delete</button>\n\
                                         <button  class='btnSummaryGrid' onclick='saveSummaryChanges(this);'><span class='glyphicon glyphicon-save'></span>Save</button>&nbsp;\n\
                                         <button  class='btnSummaryGrid' onclick='summaryCancel(this);'>Cancel</button>\n\
                                    </td>" +
                    "<td style='display:none;'><label class='labelUomFUNCTION' >INSERT</label></td>" +
                    "<td width='0%' style='display:none;'></td>" +
                    "<td width='0%' style='display:none;'><label class='labelFromUOMCODE'>" + FromUOMCode + "</label></td>" +
                    "<td><label class='labelFromUOM'>" + FromUOM + "</label><input type='text' class='modalFromUOM' disabled='disabled' value=" + FromUOM + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelFactor'>" + Factor + "</label><input type='text' class='modalFactor'  value=" + Factor + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>" +
                    "<td width='0%' style='display:none;'><label class='labelToUOMCODE'>" + ToUOMCode + "</label></td>" +
                    "<td><label class='labelToUOM'>" + ToUOM + "</label><input type='text' class='modalToUOM' disabled='disabled' value=" + ToUOM + "  style='display:none;width:200px;border:none;background:#FFFFFF;' /></td>"
                    + "</tr>");

            $(".editSummaryGrid").show();
            $(".DeleteSummaryGrid").hide();
            $(".btnSummaryGrid").hide();
            $('#ddlUOMFrom').val('');
            $('#txtFactor').val('');
            $('#ddlUOMTo').val('');
        } else {
            $.bigBoxFail({
                title: "Create UOM Conversation Fail.",
                content: "Create UOM Conversation Fail.",
                timeout: 6000
            });
            $('#ddlUOMFrom').val('');
            $('#txtFactor').val('');
            $('#ddlUOMTo').val('');
        }
        refresh_ddlPharmacyUOM();
    }

    function add_Pricing() {
            
        var booleanValue = true;
        
        //valid01
        var $validPrice1 = doubleNum($("#txtPrice1").val());
        var $validPrice2 = doubleNum($("#txtPrice2").val());
        var $validPrice3 = doubleNum($("#txtPrice3").val());
        var $validPrice4 = doubleNum($("#txtPrice4").val());
        var $validQuantity = intNum($("#txtQty").val());
        
        if ($('#ddlUOMPrice').val() === "" || $('#txtQty').val() === "" || $('#txtPrice1').val() === "") {
            //alert("Please Enter data to Add Row");
            //return false;
             $.bigBoxFail({
                title: "Create Pricing Fail.",
                content: "Create Pricing Fail.",
                timeout: 6000
            });
            return false;
        }
        //valid01
        if ($validPrice1 === false || $validPrice2 === false || $validPrice3 === false || $validPrice4 === false){
            $.bigBoxFail({
                title: "Invalid inputs.",
                content: "Please check the input for:<br>1. Price 1<br>2. Price 2<br>3. Price 3<br>4. Price 4",
                timeout: 6000
            });
            return false;
        }
        
        //valid01
        if ($validQuantity === false){
            $.bigBoxFail({
                title: "Invalid Quantity.",
                content: "Please enter a valid amount of quantity and try again...",
                timeout: 6000
            });
            return false;
        }
        
        if ($('#txtPrice1').val() === "") {
            $('#txtPrice1').val('0');
        }
        if ($('#txtPrice2').val() === "") {
            $('#txtPrice2').val('0');
        }
        if ($('#txtPrice3').val() === "") {
            $('#txtPrice3').val('0');
        }
        if ($('#txtPrice4').val() === "") {
            $('#txtPrice4').val('0');
        }

        var allPriceRowsInGrid = jQuery("#jqgridPrdPricing").jqGrid('getRowData');

        if (allPriceRowsInGrid.length > 0) {
            //booleanValue = Check_UomPrice($('#ddlUOMPrice').val(), $('#txtQty').val());
            booleanValue = true;
        } else {
            booleanValue = true;
        }


        if (booleanValue === true) {
            var $table = $(this).closest('table'),
                    QTY = $('#txtQty').val(),
                    UOM = $('#ddlUOMPrice option:selected').text(),
                    UOMCODE = $('#ddlUOMPrice').val(),
                    PRICE1 = $('#txtPrice1').val(),
                    PRICE2 = $('#txtPrice2').val(),
                    PRICE3 = $('#txtPrice3').val(),
                    PRICE4 = $('#txtPrice4').val();

            $("#tbPricing tbody").append("<tr>" +
                    "<td width='160px'>" +
                    "<button type='button' class='editSummaryGrid' onclick='summaryEdit(this);'><span class='glyphicon glyphicon-pencil'></span>Edit</button>\n\
                                         <button type='button' class='editSummaryGrid' onclick='summaryDelete(this);'><span class='glyphicon glyphicon-trash'></span>Delete</button>\n\
                                         <button type='button' class='DeleteSummaryGrid' onclick='UndoPriceDelete(this);'>Undo</button>\n\
                                         <button  class='btnSummaryGrid' onclick='savePricingChanges(this);'><span class='glyphicon glyphicon-save'></span>Save</button>\n\
                                         <button  class='btnSummaryGrid' onclick='summaryCancel(this);'>Cancel</button>\n\
                </td>" +
                    "<td><label class='labelQty'>" + QTY + "</label><input type='text' class='modalQty' disabled='disabled' value=" + QTY + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelUOM'>" + UOM + "</label><input type='text' class='modalUOM'  value=" + UOM + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice1'>" + PRICE1 + "</label><input type='text' class='modalPrice1' disabled='disabled' value=" + PRICE1 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice2'>" + PRICE2 + "</label><input type='text' class='modalPrice2' disabled='disabled' value=" + PRICE2 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice3'>" + PRICE3 + "</label><input type='text' class='modalPrice3' disabled='disabled' value=" + PRICE3 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td><label class='labelPrice4'>" + PRICE4 + "</label><input type='text' class='modalPrice4' disabled='disabled' value=" + PRICE4 + "  style='display:none;width:80px;border:none;background:#FFFFFF;' /></td>" +
                    "<td width='0%' style='display:none;'><label class='labelPriceUOMCODE'>" + UOMCODE + "</label></td>" +
                    "<td width='0%' style='display:none;'></td>" +
                    "<td width='0%' style='display:none;'><label class='labelPriceFUNCTION'>INSERT</label></td>" +
                    "</tr>"
                    );
            $(".editSummaryGrid").show();
            $(".DeleteSummaryGrid").hide();
            $(".btnSummaryGrid").hide();
            $('#txtQty').val('');
            $('#ddlUOMPrice').val('');
            $('#txtPrice1').val('');
            $('#txtPrice2').val('');
            $('#txtPrice3').val('');
            $('#txtPrice4').val('');
        }
        else {
            $.bigBoxFail({
                title: "Create Price Fail.",
                content: "Create Price Fail.",
                timeout: 6000
            });
            $('#txtQty').val('');
            $('#ddlUOMPrice').val('');
            $('#txtPrice1').val('');
            $('#txtPrice2').val('');
            $('#txtPrice3').val('');
            $('#txtPrice4').val('');

        }

    }


    function Check_UomConvert(sUomFrom, sUomTo, sFactor) {
        var allUOMRowsInGrid = jQuery("#jqgridUOMConv").jqGrid('getRowData');

        if (sUomFrom !== sUomTo) {

            var MyRows = $('#myTable').find('tbody').find('tr');
            var srecstatus = null;
            //alert(MyRows.length);
            for (var i = 0; i < MyRows.length; i++) {
                var BaseUOM = $(MyRows[i]).find('td:eq(3)').text();
                var ConvUOM = $(MyRows[i]).find('td:eq(6)').text();
                var Factor = $(MyRows[i]).find('td:eq(5)').text();
                
               // alert(sFactor + Factor);
                
                if (((sUomFrom === BaseUOM) || (sUomFrom === ConvUOM))){
                    
                    if (((sUomTo === BaseUOM) || (sUomTo === ConvUOM)) && ((parseFloat(sFactor) === parseFloat(Factor)))){ 
                        // alert("1");
                        srecstatus = false;
                        break;
                    }else{
                        srecstatus = true;
                    }
                }
                 else if (((sUomTo === BaseUOM) || (sUomTo === ConvUOM))) {
                     if (((sUomFrom === BaseUOM) || (sUomFrom === ConvUOM)) && ((parseFloat(sFactor) === parseFloat(Factor)))){ 
                   // alert("2");
                    srecstatus = false;
                    break;
                }else{
                     srecstatus = true;
                }
            }
                
         
            }

        }
        return srecstatus;

    }

    function Check_UomPrice(sPriceUOM, sFactor) {

        // alert(parseFloat(sFactor).toFixed(2));
       // var allUOMRowsInGrid = jQuery("#jqgridUOMConv").jqGrid('getRowData');
       // var allPriceRowsInGrid = jQuery("#jqgridPrdPricing").jqGrid('getRowData');



        var MyRows = $('#myTable').find('tbody').find('tr');
        var MyPrice = $('#tbPricing').find('tbody').find('tr');
        var sStatus = null;
        // alert(MyPrice.length);
        //alert(MyRows.length);
        for (var i = 0; i < MyRows.length; i++) {
            var BaseUOM = $(MyRows[i]).find('td:eq(3)').text();
            var ConvUOM = $(MyRows[i]).find('td:eq(6)').text();

            if ((sPriceUOM === BaseUOM) || (sPriceUOM === ConvUOM)) {
                for (var x = 0; x < MyPrice.length; x++) {
                    //alert(MyPrice.length);
                    var PriceUOM = $(MyPrice[x]).find('td:eq(7)').text();
                    var PriceFactor = $(MyPrice[x]).find('td:eq(1)').text();
                    // alert( x + " sPriceUOM-->" + sPriceUOM + " PriceUOM-->" + PriceUOM + " sFactor-->" + parseFloat(sFactor) + " PriceFactor-->" + parseFloat(PriceFactor));
                    //alert();
                    //alert("PriceUOM-->" +  PriceUOM);
                    // alert("PriceUOM-->" +  PriceUOM);
                    //alert("sFactor-->" + parseFloat(sFactor).toFixed(2) + " PriceFactor-->" + parseFloat(PriceFactor).toFixed(2));

                    if (sPriceUOM === PriceUOM) {
                        if ((sPriceUOM === PriceUOM) && (parseFloat(sFactor) === parseFloat(PriceFactor))) {
                            sStatus = false;
                            break;
                        } else {
                            if ((sPriceUOM === PriceUOM) && (parseFloat(sFactor) !== parseFloat(PriceFactor))) {

                                sStatus = true;

                            }
                        }
                    } else {
                        sStatus = true;
                    }

                }//end price loop
            }
        }
        return sStatus;
    }
    //c01
    //Aaron
    function confirm(){
        var $this = $(this);
        var bMandateOK = true;
        var sMsg = "";

        if ($("#txtPrdName").val().toString() === '')
        {
            sMsg = sMsg + "Product Name cannot be blank." + "\n\r";
            bMandateOK = false;
        }
        if ($("#ddlPrdGrp").val().toString() === '')
        {
            sMsg = sMsg + "Product Group must be selected." + "\n\r";
            bMandateOK = false;
        }
        if ($("#ddlPrdUOM").val().toString() === '')
        {
            sMsg = sMsg + "Product UOM must be selected." + "\n\r";
            bMandateOK = false;
        }
        if ($("#ddlAccGrp").val().toString() === '')
        {
            sMsg = sMsg + "Account Group must be selected." + "\n\r";
            bMandateOK = false;
        }
        if (!bMandateOK)
        {
            $.bigBoxFail({
                        title: "Create Product FAIL.",
                        content: sMsg,
                        timeout: 3000
                    });
        }
        var UOMConvertData = new Array();
        $('#myTable tr').each(function (row, th) {
            UOMConvertData[row] = {
                "FUNCTION": $(th).find('td:eq(1)').text()
                , "IDX": $(th).find('td:eq(2)').text()
                , "BASEDUOM": $(th).find('td:eq(3)').text()
                , "FACTOR": $(th).find('td:eq(5)').text()
                , "TOUOM": $(th).find('td:eq(6)').text()
                , "STOCKCODE": $('#lblPrdCode').val()

            };
            // sum +=   parseFloat($(th).find('td:eq(7)').text()); 
        });

        UOMConvertData.splice(0, 1);

        var ItemToSend = JSON.stringify(UOMConvertData);
        $('#hidUOMConvert').load().val(ItemToSend).valid();
        // alert($('#hidUOMConvert').val());

        var PrdPriceData = new Array(); 
        $('#tbPricing tr').each(function (row, th) { 
//            alert("IDX : " + $(th).find('td:eq(8)').text());
//            alert("UOM : " + $(th).find('td:eq(7)').text());
            PrdPriceData[row] = {
                "FUNCTION": $(th).find('td:eq(9)').text()
                , "IDX": $(th).find('td:eq(8)').text()
                , "STOCKCODE": $('#lblPrdCode').val()
                , "FACTOR": $(th).find('td:eq(1)').text()
                , "UOM": $(th).find('td:eq(7)').text()
                , "PRICE1": $(th).find('td:eq(3)').text()
                , "PRICE2": $(th).find('td:eq(4)').text()
                , "PRICE3": $(th).find('td:eq(5)').text()
                , "PRICE4": $(th).find('td:eq(6)').text()
            };
        });
        PrdPriceData.splice(0, 1);

        var ItemPrice = JSON.stringify(PrdPriceData);
        $('#hidPricing').load().val(ItemPrice).valid();
        // alert($('#hidPricing').val());

        var $validProduct = $("#form_ProductDetail").valid();
        //valid01
        var $validUnitCost = doubleNum($("#txtUnitCost").val());
        var $validPharCost = doubleNum($("#txtPharmacyUnitCost").val());
            
        if ($validProduct === true && $validUnitCost === true && $validPharCost === true) {
            document.getElementById("btnSave").disabled = true;
            showYesNo({
                title: "Confirmation needed",
                width: 420,
                noClose: true,
                isModal: true,
                body: [
                   "<br><h4>Are you sure to proceed this action?<h4><br>"
                ],
                show: function(){},
                Yes: {
                    text: "Yes",
                    opt: function(){
                       updateDetail();
                       hideYesNo();
                   }
               },
               No:{
                   text: "No",
                   opt: function(){
                       document.getElementById("btnSave").disabled = false;
                       hideYesNo();
                   }
               }
            });
        }
        //valid01
        else if ($validUnitCost === false){
            $.bigBoxFail({
                title: "Invalid Unit Cost.",
                content: "Please enter a valid unit cost and try again...",
                timeout: 6000
            });
        }
        //valid01
        else if ($validPharCost === false){
            $.bigBoxFail({
                title: "Invalid Pharmacy Unit Cost.",
                content: "Please enter a valid pharmacy unit cost and try again...",
                timeout: 6000
            });
        }
    }
    //c01
    //Aaron
    function updateDetail(){
        var $this = $(this);
        $.ajax({
            type: "POST",
            url: "${pageContext.request.contextPath}/Servlet_Stock?SFC=UPDATE_PRODUCT",
            data: {
                UPDPROD: JSON.stringify($('#form_ProductDetail').serializeArray()),
                UOMCONV: $('#hidUOMConvert').val(),
                PRDPRICE: $('#hidPricing').val(),
                ISACTIVE: $('#chkIsActive').val(),
                PRD_API: $('#txtPrdAPI').val()
            },
            dataType: 'json',
            beforeSend: function (xhr) {
                $.showLoadingNoStatus();
            },
            success: function(response, status, xhr) {
                if (response.bool === true) {
                    $.bigBoxSuccess({
                        title: "Product Success Updated.",
                        content: "Product Success Updated.",
                        timeout: 6000
                    });
                }
                else{
                    $.bigBoxFail({
                        title: "Update Product FAIL.",
                        content: "There is some error during product creation.<br> Please try again...",
                        timeout: 6000
                    });
                }
                    
            },
            error: function (xhr, status, error) {
                $.bigBoxFail({
                    title: "Transaction ERROR",
                    content: "There is some error occur during data transfer. Please try again later",
                    timeout: 6000
                });
            },
            complete: function (xhr, status) {
                if (xhr.status === 200) {
                    $.hideLoadingNoStatus(function () {
                       location.reload();
                    }, 500);
                } else {
                    $.hideLoadingNoStatus(function () {
                    }, 0);
                }
            }
        });
    }
    //c01
    //Aaron


    function previewImg(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function (e) { 
                $('#imgLogo').attr('src', e.target.result);
            };          
            reader.readAsDataURL(input.files[0]);
        }
        $('#btnLoad').show();
    }

    function loadLogoFile(){
//        var a = JSON.stringify($('#testing').serializeArray());
//        alert(a);
//        var abc = JSON.stringify($('#formUploadImg').serializeArray());
//        alert(abc);
        $("#upload").trigger( "click" );
    }

     //valid01
    function intNum(num){
        var reg = /^[0-9]+$/;
        if (num === ""){
            return true;
        }
        else{
            return reg.test(num);
        }
    }
    
    //valid01
    function doubleNum(num){
        var reg = /^[0-9]+(\.[0-9][0-9]?[0-9]?)?$/;
        if (num === ""){
            return true;
        }
        else{
            return reg.test(num);
        }
    }
    //valid01
    function twoDeci(num){
        var reg = /^[0-9]+(\.[0-9][0-9]?)?$/;
        if (num === ""){
            return true;
        }
        else{
            return reg.test(num);
        }
    }

</script>