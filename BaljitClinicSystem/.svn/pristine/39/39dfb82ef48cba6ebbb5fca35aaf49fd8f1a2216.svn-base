<!--
Modification ID     By          Date        Comment
------------------------------------------------------------------------------------
yesno01             Aaron       17Dec2018   include yes-no.jsp in the code
c01                 Aaron       17Dec2018   add confirm function and updateUOM function 
name01              Aaron       27Dec2018   change name for btnSave
font01              Aaron       27Dec2018   change font style and color for mandatory fields
len01               Aaron       27Dec2018   set maxlength for textbox
validate01          Aaron       02Jan2018   add validation for mandatory fields   
gg01                    Aaron   08Jan2019   add condition to remove box shadow
-->
<%@taglib prefix="jstl" uri="http://java.sun.com/jsp/jstl/core" %>
<jsp:useBean id="DDL" scope="page" class="BusinessLogic.Servlet_PopulateData" />
<style type="text/css">
    .ui-jqgrid tr.jqgrow td {
        word-wrap: break-word; /* IE 5.5+ CSS3 see http://www.w3.org/TR/css3-text/#text-wrap */
        white-space: pre-wrap; /* CSS3 */
        white-space: -moz-pre-wrap; /* Mozilla, since 1999 */
        white-space: -pre-wrap; /* Opera 4-6 */
        white-space: -o-pre-wrap; /* Opera 7 */
        overflow: hidden;
        height: auto;
        vertical-align: middle;
        padding-top: 3px;
        padding-bottom: 3px 
    }

    .centered {
        position: fixed;
        top: 50%;
        left: 50%;
        margin-top: -50px;
        margin-left: -200px;
    }
    div.errorContainer, div.errorContainer2{
        display:none;
        width:100%;
    }
    div.errorContainer, div.errorContainer2 ol li{
        list-style-type:disc;
        margin-left: 20px;
    }
    select:disabled{
        background: #dddddd;
    }
    li{
        list-style:none;
    }
    .disabledTab{
        pointer-events: none;
    }
    input[type="text"].error { border: 1px solid #A94444; background-color:#FFF0F0; }
    select.error { border: 1px solid #A94444; background-color:#FFF0F0; }
    textarea.error { border: 1px solid #A94444; background-color:#FFF0F0; }
    /*gg01*/
    input[type="text"]:read-only {box-shadow: none;}
    textarea:read-only {box-shadow: none;}
    .col-lg-12{float: none;}
    .col-md-12{float:none;}
    .col-sm-12{float:none;}
    .col-xs-12{float:none;}
</style>
<link rel="stylesheet" type="text/css" href="css/your_style.css" />
<link rel="stylesheet" type="text/css" href="js/plugin/jqgrid/ui.multiselect.css" />
<section id="widget-grid" class="">
    <!--<span>{{params}}</span>-->
    <input type="hidden" value={{params}} id="hidSupCode">

    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-12">
        <h1 class="page-title txt-color-blueDark">
            <!-- PAGE HEADER -->
            <i class="fa-fw fa fa-file fa-2x"></i> 
            UOM Detail                                         
        </h1>
    </div>
    <div class="widget-body row">
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="row" style="padding-bottom:10px;padding-left:10px;padding-right:10px;">
                <div class="errorContainer alert alert-danger alert-block">
                    <h4 class="alert-heading">There were some field left out or invalid inputs. Please brief through the form and reenter necessarily.</h4>
                    <ol>
                    </ol>
                </div>
            </div>
            <div class="row">
                <form id="form_AddSupplier" name="form_AddSupplier">
                    <article class="col-sm-12 col-md-12 col-lg-12">
                        <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-1"  data-widget-editbutton="false" data-widget-custombutton="false"
                             data-widget-deletebutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-togglebutton="false">
                            <header>
                                <span class="widget-icon"> <i class="fa fa-file"></i></span>
                                <span><h2>&nbsp;General Info</h2></span>
                            </header>
                            <div class="row">
                                <div class="widget-body">

                                    <table id="tbSupplierInfo" class="table table-bordered table-striped" style="clear:both;">
                                        <tbody>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>UOM Code</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="35%"> 
                                                    <input type="text" id="lblUOMCode" name="lblUOMCode" readonly  class="tboxreadonly" rel="popover-hover" data-original-title="UOM Code" data-content="UOM Code is an unique mixture of alphanumerical code with a maximum length of 10 characters." />  
                                                    <input type="hidden" id="txtUOMCode" name="txtUOMCode" class="tboxreadonly" readonly/>
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td width="12%"><font color="red">*</font> <b>UOM Description</b></td> <!--font01-->
                                                <td width="1%">:</td>
                                                <td width="35%">     
                                                    <input type="text" id="lblUOMName" name="lblUOMName" readonly  class="tboxreadonly" />    
                                                    <input type="text" id="txtUOMDesc" name="txtUOMDesc" class="form-control" style="width:220px;display:none" maxlength="50"/> <!--len01--> 
                                                </td>
                                                 
                                                 
                                            </tr>
                                            <tr>
                                              <td width="12%">Record Status</td>
                                              <td width="1%">:</td>
                                                <td width="35%"> 
                                             
                                                    <input type="checkbox" id="chkrecstatus" name="chkrecstatus" value="0"/>  
                                                    
                                                </td>
                                            </tr> 
                                             
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </article>

                   
                </form>
            </div>

        </article>
        <div>
            <div class="row">
                <div class="col-sm-12">
                    <div align="center" class="padding-5" >
                        <input type="button" class="btn btn-default bg-color-blueDark txt-color-white form-btn" id="btnEdit" name="btnEdit" value="Edit Detail" onclick="enableEdit()" style="margin-right:20px;"/>
                        <input type="button" Id="btnSave"  class="btn btn-default bg-color-blueDark txt-color-white" value="Update" style="display: none" onclick="confirm();" /> <!--name01-->
                        <input type="button" Id="btnCancel"  class="btn btn-default bg-color-blueDark txt-color-white"  value="Cancel" onclick="location.href = '#/UOMMasterList'" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<jsp:include page="../../../includes/loading-no-status.jsp"/>
<!--yesno01-->
<jsp:include page="../../../includes/yes-no.jsp"/>
<!--<script src="js/buttonset.js"></script>-->
<script type="text/javascript">
    //pageSetUp();
   
    function bindData(sParam) {
         //alert("sparam-->" + JSON.stringify(sParam.UOMCODE));
        var pagefunction = function () {             
          //  run_jqgrid_function();
           // function run_jqgrid_function() {
           //validate01
           var container = $('div.errorContainer');
           var validator = $("#form_AddSupplier").validate({
                rules: {
                    txtUOMDesc: "required"
                },
                messages: {
                    txtUOMDesc: "UOM Name cannot be blank."
                },
                errorContainer: container,
                errorLabelContainer: $("ol", container),
                wrapper: 'li'
            });  
            //validate01
                $.get('${pageContext.request.contextPath}/Servlet_StockUOM', {UOMCODE: sParam.UOMCODE, SFC: 'GET_STKUOM_DETAIL'}, function (data) {
                    var arrData = data.object1[0];

                    $('#lblUOMCode').val(arrData.uom_uomcode);
                     
                    $('#lblUOMName').val(arrData.uom_uomdesc);
                     
                    
                             
                    if(arrData.recstatus === '1'){ 
                                $('#chkrecstatus').prop('checked', true); 
                                $('#chkrecstatus').val('1');
                            } else 
                                $('#chkrecstatus').val('0');
                     
                });
           // };
        };
         //loadScript("js/plugin/jqgrid/grid.locale-en.min.js", pagefunction);
         pagefunction();
    } 
   
   
     
    $("#chkrecstatus").click(function(){
                if ( $('#chkrecstatus').is(":checked") )
                    $('#chkrecstatus').val('1'); 
                else
                    $('#chkrecstatus').val('0');            
            });
    
    function enableEdit() {
        $.showLoadingNoStatus();
        document.getElementById('btnSave').style.display = '';
        document.getElementById('btnEdit').style.display = 'none';

        document.getElementById('txtUOMCode').value = document.getElementById('lblUOMCode').value;        
        
        document.getElementById('lblUOMName').style.display = 'none';
        document.getElementById('txtUOMDesc').value = document.getElementById('lblUOMName').value;
        document.getElementById('txtUOMDesc').style.display = '';

       
        
        
        

        $.hideLoadingNoStatus();
    }
    //c01
    //Aaron
    function confirm(){
        var $validSupplier = $("#form_AddSupplier").valid();

        if ($validSupplier === true) {
            document.getElementById("btnSave").disabled = true;
            showYesNo({
                title: "Confirmation needed",
                width: 420,
                noClose: true,
                isModal: true,
                body: [
                   "<br><h4>Please confirm all the details entered.<h4><br>"
                ],
                show: function(){},
                Yes: {
                    text: "Yes",
                    opt: function(){
                       updateUOM();
                       hideYesNo();
                   }
               },
               No: {
                   text: "No",
                   opt: function(){
                       document.getElementById("btnSave").disabled = false;
                       hideYesNo();
                   }
               }
            });
        }
    }
    //c01
    function updateUOM(){
        var $this = $(this);
        $.ajax({
            type: "POST",
            url: "${pageContext.request.contextPath}/Servlet_StockUOM?SFC=UPDATE_STKUOM",
            data: {
                ADDUOM: JSON.stringify($('#form_AddSupplier').serializeArray()),
                MODE: "UPDATE_STKUOM"
            },
            dataType: 'json',
            beforeSend: function (xhr) {
                $.showLoadingNoStatus();
            },
            success: function(response,xhr,status){
                if (response.bool === true) {
                    $.bigBoxSuccess({
                        title: "UOM Success Updated.",
                        content: "UOM Success Updated.",
                        timeout: 6000
                    });
                }
                else{
                    $.bigBoxFail({
                        title: "Update UOM FAIL.",
                        content: "There is some error during UOM update.<br> Please try again...",
                        timeout: 6000
                    });
                }
            },
            error: function (xhr, status, error) {
                $.bigBoxFail({
                    title: "Transaction ERROR",
                    content: "There is some error occur during data transfer. Please try again later",
                    timeout: 6000
                 });
            },
            complete: function (xhr, status) {
                if (xhr.status === 200) {
                    $.hideLoadingNoStatus(function () {
                       location.reload();
                    }, 500);
                } else {
                    $.hideLoadingNoStatus(function () {
                    }, 0);
                }
            }
        });
    }
    //c01
//    $("#btnSave").click(function () {        
//        var $validSupplier = $("#form_AddSupplier").valid();
//
//        if ($validSupplier === true) {
//            var request = $.ajax({
//                type: "POST",
//                url: "${pageContext.request.contextPath}/Servlet_StockUOM?SFC=UPDATE_STKUOM",
//                data: {
//                    ADDUOM: JSON.stringify($('#form_AddSupplier').serializeArray()),
//                    MODE: "UPDATE_STKUOM"
//                },
//                dataType: 'json',
//                beforeSend: function () {
//                    //  $.showLoadingNoStatus();
//                }
//            });
//
//            request.done(function (response) {
////             $.hideLoadingNoStatus(function () {
////                 
////                }, 500);
//                //alert('aaa');
//                // alert(response.bool);
//
//                if (response.bool === true) {
//                    $.bigBoxSuccess({
//                        title: "UOM Success Updated.",
//                        content: "UOM Success Updated.",
//                        timeout: 6000
//                    });
//                    location.reload();
//                } else {
//                    $.bigBoxFail({
//                        title: "Update UOM FAIL.",
//                        content: "There is some error during UOM update.<br> Please try again...",
//                        timeout: 6000
//                    });
//                }
//            });
//        }
//    });
</script>
